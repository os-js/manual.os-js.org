[
  {
    "__docId__": 1,
    "kind": "external",
    "name": "Infinity",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Infinity",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Infinity",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 2,
    "kind": "external",
    "name": "NaN",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/NaN",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~NaN",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 3,
    "kind": "external",
    "name": "undefined",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~undefined",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 4,
    "kind": "external",
    "name": "null",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/null",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~null",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 5,
    "kind": "external",
    "name": "Object",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Object",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 6,
    "kind": "external",
    "name": "object",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~object",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 7,
    "kind": "external",
    "name": "Function",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Function",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 8,
    "kind": "external",
    "name": "function",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~function",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 9,
    "kind": "external",
    "name": "Boolean",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Boolean",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 10,
    "kind": "external",
    "name": "boolean",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~boolean",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 11,
    "kind": "external",
    "name": "Symbol",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Symbol",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 12,
    "kind": "external",
    "name": "Error",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Error",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 13,
    "kind": "external",
    "name": "EvalError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/EvalError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~EvalError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 14,
    "kind": "external",
    "name": "InternalError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/InternalError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~InternalError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 15,
    "kind": "external",
    "name": "RangeError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RangeError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~RangeError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 16,
    "kind": "external",
    "name": "ReferenceError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ReferenceError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~ReferenceError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 17,
    "kind": "external",
    "name": "SyntaxError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SyntaxError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~SyntaxError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 18,
    "kind": "external",
    "name": "TypeError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypeError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~TypeError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 19,
    "kind": "external",
    "name": "URIError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/URIError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~URIError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 20,
    "kind": "external",
    "name": "Number",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Number",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 21,
    "kind": "external",
    "name": "number",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~number",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 22,
    "kind": "external",
    "name": "Date",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Date",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 23,
    "kind": "external",
    "name": "String",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~String",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 24,
    "kind": "external",
    "name": "string",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~string",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 25,
    "kind": "external",
    "name": "RegExp",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~RegExp",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 26,
    "kind": "external",
    "name": "Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 27,
    "kind": "external",
    "name": "Int8Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int8Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Int8Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 28,
    "kind": "external",
    "name": "Uint8Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Uint8Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 29,
    "kind": "external",
    "name": "Uint8ClampedArray",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8ClampedArray",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Uint8ClampedArray",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 30,
    "kind": "external",
    "name": "Int16Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int16Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Int16Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 31,
    "kind": "external",
    "name": "Uint16Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint16Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Uint16Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 32,
    "kind": "external",
    "name": "Int32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int32Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Int32Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 33,
    "kind": "external",
    "name": "Uint32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint32Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Uint32Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 34,
    "kind": "external",
    "name": "Float32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float32Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Float32Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 35,
    "kind": "external",
    "name": "Float64Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float64Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Float64Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 36,
    "kind": "external",
    "name": "Map",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Map",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 37,
    "kind": "external",
    "name": "Set",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Set",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 38,
    "kind": "external",
    "name": "WeakMap",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakMap",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~WeakMap",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 39,
    "kind": "external",
    "name": "WeakSet",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakSet",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~WeakSet",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 40,
    "kind": "external",
    "name": "ArrayBuffer",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~ArrayBuffer",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 41,
    "kind": "external",
    "name": "DataView",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~DataView",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 42,
    "kind": "external",
    "name": "JSON",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~JSON",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 43,
    "kind": "external",
    "name": "Promise",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Promise",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 44,
    "kind": "external",
    "name": "Generator",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Generator",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 45,
    "kind": "external",
    "name": "GeneratorFunction",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/GeneratorFunction",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~GeneratorFunction",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 46,
    "kind": "external",
    "name": "Reflect",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Reflect",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Reflect",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 47,
    "kind": "external",
    "name": "Proxy",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Proxy",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 48,
    "kind": "file",
    "name": "src/adapters/auth/null.js",
    "content": "/*\n * OS.js - JavaScript Cloud/Web Desktop Platform\n *\n * Copyright (c) Anders Evenrud <andersevenrud@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * @author  Anders Evenrud <andersevenrud@gmail.com>\n * @licence Simplified BSD License\n */\n\n/**\n * Null Auth adapter\n * @param {Core} core Core reference\n * @param {object} [options] Adapter options\n */\nmodule.exports = (core, options) => ({\n  init: async () => true,\n  destroy: async () => true,\n  register: async (req, res) => ({username: req.body.username}),\n  login: async (req, res) => ({id: 0, username: req.body.username}),\n  logout: async (req, res) => true\n});\n\n",
    "static": true,
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/src/adapters/auth/null.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 49,
    "kind": "function",
    "name": "null",
    "memberof": "src/adapters/auth/null.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/adapters/auth/null.js~null",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/adapters/auth/null.js",
    "importStyle": "null",
    "description": "Null Auth adapter",
    "lineNumber": 36,
    "params": [
      {
        "nullable": null,
        "types": [
          "Core"
        ],
        "spread": false,
        "optional": false,
        "name": "core",
        "description": "Core reference"
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": true,
        "name": "options",
        "description": "Adapter options"
      }
    ],
    "return": null
  },
  {
    "__docId__": 50,
    "kind": "file",
    "name": "src/adapters/settings/fs.js",
    "content": "/*\n * OS.js - JavaScript Cloud/Web Desktop Platform\n *\n * Copyright (c) Anders Evenrud <andersevenrud@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * @author  Anders Evenrud <andersevenrud@gmail.com>\n * @licence Simplified BSD License\n */\nconst fs = require('fs-extra');\nconst path = require('path');\n\n/**\n * FS Settings adapter\n * @param {Core} core Core reference\n * @param {object} [options] Adapter options\n */\nmodule.exports = (core, options) => {\n  const fsOptions = {\n    system: false,\n    path: 'home:/.osjs/settings.json',\n    ...options || {}\n  };\n\n  const getRealFilename = (req) => fsOptions.system\n    ? Promise.resolve(fsOptions.path)\n    : core.make('osjs/vfs')\n      .realpath(fsOptions.path, req.session.user);\n\n  const before = req => getRealFilename(req)\n    .then(filename => fs.ensureDir(path.dirname(filename))\n      .then(() => filename));\n\n  const save = req => before(req)\n    .then(filename => fs.writeJson(filename, req.body))\n    .then(() => true);\n\n  const load = req => before(req)\n    .then(filename => fs.readJson(filename))\n    .catch(error => {\n      core.logger.warn(error);\n      return {};\n    });\n\n  return {save, load};\n};\n\n",
    "static": true,
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/src/adapters/settings/fs.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 51,
    "kind": "function",
    "name": "fs",
    "memberof": "src/adapters/settings/fs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/adapters/settings/fs.js~fs",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/adapters/settings/fs.js",
    "importStyle": "fs",
    "description": "FS Settings adapter",
    "lineNumber": 38,
    "params": [
      {
        "nullable": null,
        "types": [
          "Core"
        ],
        "spread": false,
        "optional": false,
        "name": "core",
        "description": "Core reference"
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": true,
        "name": "options",
        "description": "Adapter options"
      }
    ],
    "return": {
      "types": [
        "{\"save\": *, \"load\": *}"
      ]
    }
  },
  {
    "__docId__": 52,
    "kind": "file",
    "name": "src/adapters/settings/null.js",
    "content": "/*\n * OS.js - JavaScript Cloud/Web Desktop Platform\n *\n * Copyright (c) Anders Evenrud <andersevenrud@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * @author  Anders Evenrud <andersevenrud@gmail.com>\n * @licence Simplified BSD License\n */\n\n/**\n * Null Settings adapter\n * @param {Core} core Core reference\n * @param {object} [options] Adapter options\n */\nmodule.exports = (core, options) => ({\n  init: async () => true,\n  destroy: async () => true,\n  save: async () => true,\n  load: async () => ({})\n});\n\n",
    "static": true,
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/src/adapters/settings/null.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 53,
    "kind": "function",
    "name": "null",
    "memberof": "src/adapters/settings/null.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/adapters/settings/null.js~null",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/adapters/settings/null.js",
    "importStyle": "null",
    "description": "Null Settings adapter",
    "lineNumber": 36,
    "params": [
      {
        "nullable": null,
        "types": [
          "Core"
        ],
        "spread": false,
        "optional": false,
        "name": "core",
        "description": "Core reference"
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": true,
        "name": "options",
        "description": "Adapter options"
      }
    ],
    "return": null
  },
  {
    "__docId__": 54,
    "kind": "file",
    "name": "src/adapters/vfs/system.js",
    "content": "/*\n * OS.js - JavaScript Cloud/Web Desktop Platform\n *\n * Copyright (c) Anders Evenrud <andersevenrud@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * @author  Anders Evenrud <andersevenrud@gmail.com>\n * @licence Simplified BSD License\n */\n\nconst fs = require('fs-extra');\nconst path = require('path');\nconst fh = require('filehound');\nconst chokidar = require('chokidar');\n\n/*\n * Creates an object readable by client\n */\nconst createFileIter = (core, realRoot, file) => {\n  const filename = path.basename(file);\n  const realPath = path.join(realRoot, filename);\n  const {mime} = core.make('osjs/vfs');\n\n  const createStat = stat => ({\n    isDirectory: stat.isDirectory(),\n    isFile: stat.isFile(),\n    mime: stat.isFile() ? mime(realPath) : null,\n    size: stat.size,\n    path: file,\n    filename,\n    stat\n  });\n\n  return fs.stat(realPath)\n    .then(createStat)\n    .catch(error => {\n      core.logger.warn(error);\n\n      return createStat({\n        isDirectory: () => false,\n        isFile: () => true,\n        size: 0\n      });\n    });\n};\n\n/*\n * Segment value map\n */\nconst segments = {\n  root: {\n    dynamic: false,\n    fn: () => process.cwd()\n  },\n\n  vfs: {\n    dynamic: false,\n    fn: core => core.config('vfs.root', process.cwd())\n  },\n\n  username: {\n    dynamic: true,\n    fn: (core, session) => session.user.username\n  }\n};\n\n/*\n * Gets a segment value\n */\nconst getSegment = (core, session, seg) => segments[seg] ? segments[seg].fn(core, session) : '';\n\n/*\n * Matches a string for segments\n */\nconst matchSegments = str => (str.match(/(\\{\\w+\\})/g) || []);\n\n/*\n * Resolves a string with segments\n */\nconst resolveSegments = (core, session, str) => matchSegments(str)\n  .reduce((result, current) => result.replace(current, getSegment(core, session, current.replace(/(\\{|\\})/g, ''))), str);\n\n/*\n * Resolves a given file path based on a request\n * Will take out segments from the resulting string\n * and replace them with a list of defined variables\n */\nconst getRealPath = (core, session, mount, file) => {\n  const root = resolveSegments(core, session, mount.attributes.root);\n  const str = file.substr(mount.root.length - 1);\n  return path.join(root, str);\n};\n\n/**\n * System VFS adapter\n * @param {Core} core Core reference\n * @param {object} [options] Adapter options\n */\nmodule.exports = (core) => {\n  const wrapper = (method, cb, ...args) => vfs => (file, options = {}) => {\n    const promise = Promise.resolve(getRealPath(core, options.session, vfs.mount, file))\n      .then(realPath => fs[method](realPath, ...args));\n\n    return typeof cb === 'function'\n      ? cb(promise, options)\n      : promise.then(() => true);\n  };\n\n  const crossWrapper = method => (srcVfs, destVfs) => (src, dest, options = {}) => Promise.resolve({\n    realSource: getRealPath(core, options.session, srcVfs.mount, src),\n    realDest: getRealPath(core, options.session, destVfs.mount, dest)\n  })\n    .then(({realSource, realDest}) => fs[method](realSource, realDest))\n    .then(() => true);\n\n  return {\n    watch: (mount, callback) => {\n      const dest = resolveSegments(core, {\n        user: {\n          username: '**'\n        }\n      }, mount.attributes.root);\n\n      const watch = chokidar.watch(dest, mount.attributes.chokidar || {});\n      const restr = dest.replace(/\\*\\*/g, '([^/]*)');\n      const re = new RegExp(restr + '/(.*)');\n      const seg =  matchSegments(mount.attributes.root)\n        .map(s => s.replace(/\\{|\\}/g, ''))\n        .filter(s => segments[s].dynamic);\n\n      const handle = name => file => {\n        const test = re.exec(file);\n\n        if (test && test.length > 0) {\n          const args = seg.reduce((res, k, i) => ({[k]: test[i + 1]}), {});\n          callback(args, test[test.length - 1], name);\n        }\n      };\n\n      const events = ['add', 'addDir', 'unlinkDir', 'unlink'];\n      events.forEach(name => watch.on(name, handle(name)));\n\n      return watch;\n    },\n\n    /**\n     * Get filesystem capabilities\n     * @param {String} file The file path from client\n     * @param {Object} [options={}] Options\n     * @return {Object[]}\n     */\n    capabilities: vfs => (file, options = {}) =>\n      Promise.resolve({\n        sort: false,\n        pagination: false\n      }),\n\n    /**\n     * Checks if file exists\n     * @param {String} file The file path from client\n     * @param {Object} [options={}] Options\n     * @return {Promise<boolean, Error>}\n     */\n    exists: wrapper('access', promise => {\n      return promise.then(() => true)\n        .catch(() => false);\n    }, fs.F_OK),\n\n    /**\n     * Get file statistics\n     * @param {String} file The file path from client\n     * @param {Object} [options={}] Options\n     * @return {Object}\n     */\n    stat: vfs => (file, options = {}) =>\n      Promise.resolve(getRealPath(core, options.session, vfs.mount, file))\n        .then(realPath => {\n          return fs.access(realPath, fs.F_OK)\n            .then(() => createFileIter(core, path.dirname(realPath), realPath));\n        }),\n\n    /**\n     * Reads directory\n     * @param {String} root The file path from client\n     * @param {Object} [options={}] Options\n     * @return {Object[]}\n     */\n    readdir: vfs => (root, options) =>\n      Promise.resolve(getRealPath(core, options.session, vfs.mount, root))\n        .then(realPath => fs.readdir(realPath).then(files => ({realPath, files})))\n        .then(({realPath, files}) => {\n          const promises = files.map(f => createFileIter(core, realPath, root.replace(/\\/?$/, '/') + f));\n          return Promise.all(promises);\n        }),\n\n    /**\n     * Reads file stream\n     * @param {String} file The file path from client\n     * @param {Object} [options={}] Options\n     * @return {stream.Readable}\n     */\n    readfile: vfs => (file, options = {}) =>\n      Promise.resolve(getRealPath(core, options.session, vfs.mount, file))\n        .then(realPath => fs.stat(realPath).then(stat => ({realPath, stat})))\n        .then(({realPath, stat}) => {\n          if (!stat.isFile()) {\n            return false;\n          }\n\n          const range = options.range || [];\n          return fs.createReadStream(realPath, {\n            flags: 'r',\n            start: range[0],\n            end: range[1]\n          });\n        }),\n\n    /**\n     * Creates directory\n     * @param {String} file The file path from client\n     * @param {Object} [options={}] Options\n     * @return {boolean}\n     */\n    mkdir: wrapper('mkdir', (promise, options = {}) => {\n      return promise\n        .then(() => true)\n        .catch(e => {\n          if (options.ensure && e.code === 'EEXIST') {\n            return true;\n          }\n\n          return Promise.reject(e);\n        });\n    }),\n\n    /**\n     * Writes file stream\n     * @param {String} file The file path from client\n     * @param {stream.Readable} data The stream\n     * @param {Object} [options={}] Options\n     * @return {Promise<boolean, Error>}\n     */\n    writefile: vfs => (file, data, options = {}) => new Promise((resolve, reject) => {\n      // FIXME: Currently this actually copies the file because\n      // formidable will put this in a temporary directory.\n      // It would probably be better to do a \"rename()\" on local filesystems\n      const realPath = getRealPath(core, options.session, vfs.mount, file);\n\n      const write = () => {\n        const stream = fs.createWriteStream(realPath);\n        data.on('error', err => reject(err));\n        data.on('end', () => resolve(true));\n        data.pipe(stream);\n      };\n\n      fs.stat(realPath).then(stat => {\n        if (stat.isDirectory()) {\n          resolve(false);\n        } else {\n          write();\n        }\n      }).catch((err) => err.code === 'ENOENT' ? write()  : reject(err));\n    }),\n\n    /**\n     * Renames given file or directory\n     * @param {String} src The source file path from client\n     * @param {String} dest The destination file path from client\n     * @param {Object} [options={}] Options\n     * @return {boolean}\n     */\n    rename: crossWrapper('rename'),\n\n    /**\n     * Copies given file or directory\n     * @param {String} src The source file path from client\n     * @param {String} dest The destination file path from client\n     * @param {Object} [options={}] Options\n     * @return {boolean}\n     */\n    copy: crossWrapper('copy'),\n\n    /**\n     * Removes given file or directory\n     * @param {String} file The file path from client\n     * @param {Object} [options={}] Options\n     * @return {boolean}\n     */\n    unlink: wrapper('remove'),\n\n    /**\n     * Searches for files and folders\n     * @param {String} file The file path from client\n     * @param {Object} [options={}] Options\n     * @return {boolean}\n     */\n    search: vfs => (root, pattern, options = {}) =>\n      Promise.resolve(getRealPath(core, options.session, vfs.mount, root))\n        .then(realPath => {\n          return fh.create()\n            .paths(realPath)\n            .match(pattern)\n            .find()\n            .then(files => ({realPath, files}))\n            .catch(err => {\n              core.logger.warn(err);\n\n              return {realPath, files: []};\n            });\n        })\n        .then(({realPath, files}) => {\n          const promises = files.map(f => {\n            const rf = f.substr(realPath.length);\n            return createFileIter(\n              core,\n              path.dirname(realPath.replace(/\\/?$/, '/') + rf),\n              root.replace(/\\/?$/, '/') + rf\n            );\n          });\n          return Promise.all(promises);\n        }),\n\n    /**\n     * Touches a file\n     * @param {String} file The file path from client\n     * @param {Object} [options={}] Options\n     * @return {boolean}\n     */\n    touch: wrapper('ensureFile'),\n\n    /**\n     * Gets the real filesystem path (internal only)\n     * @param {String} file The file path from client\n     * @param {Object} [options={}] Options\n     * @return {string}\n     */\n    realpath: vfs => (file, options = {}) =>\n      Promise.resolve(getRealPath(core, options.session, vfs.mount, file))\n  };\n};\n",
    "static": true,
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/src/adapters/vfs/system.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 55,
    "kind": "function",
    "name": "createFileIter",
    "memberof": "src/adapters/vfs/system.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/adapters/vfs/system.js~createFileIter",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/adapters/vfs/system.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 39,
    "undocument": true,
    "params": [
      {
        "name": "core",
        "types": [
          "*"
        ]
      },
      {
        "name": "realRoot",
        "types": [
          "*"
        ]
      },
      {
        "name": "file",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 56,
    "kind": "variable",
    "name": "segments",
    "memberof": "src/adapters/vfs/system.js",
    "static": true,
    "longname": "src/adapters/vfs/system.js~segments",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/adapters/vfs/system.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 70,
    "undocument": true,
    "type": {
      "types": [
        "{\"root\": *, \"vfs\": *, \"username\": *}"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 57,
    "kind": "function",
    "name": "getSegment",
    "memberof": "src/adapters/vfs/system.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/adapters/vfs/system.js~getSegment",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/adapters/vfs/system.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 90,
    "undocument": true,
    "params": [
      {
        "name": "core",
        "types": [
          "*"
        ]
      },
      {
        "name": "session",
        "types": [
          "*"
        ]
      },
      {
        "name": "seg",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 58,
    "kind": "function",
    "name": "matchSegments",
    "memberof": "src/adapters/vfs/system.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/adapters/vfs/system.js~matchSegments",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/adapters/vfs/system.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 95,
    "undocument": true,
    "params": [
      {
        "name": "str",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 59,
    "kind": "function",
    "name": "resolveSegments",
    "memberof": "src/adapters/vfs/system.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/adapters/vfs/system.js~resolveSegments",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/adapters/vfs/system.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 100,
    "undocument": true,
    "params": [
      {
        "name": "core",
        "types": [
          "*"
        ]
      },
      {
        "name": "session",
        "types": [
          "*"
        ]
      },
      {
        "name": "str",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 60,
    "kind": "function",
    "name": "getRealPath",
    "memberof": "src/adapters/vfs/system.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/adapters/vfs/system.js~getRealPath",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/adapters/vfs/system.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 108,
    "undocument": true,
    "params": [
      {
        "name": "core",
        "types": [
          "*"
        ]
      },
      {
        "name": "session",
        "types": [
          "*"
        ]
      },
      {
        "name": "mount",
        "types": [
          "*"
        ]
      },
      {
        "name": "file",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 61,
    "kind": "function",
    "name": "system",
    "memberof": "src/adapters/vfs/system.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/adapters/vfs/system.js~system",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/adapters/vfs/system.js",
    "importStyle": "system",
    "description": "System VFS adapter",
    "lineNumber": 119,
    "params": [
      {
        "nullable": null,
        "types": [
          "Core"
        ],
        "spread": false,
        "optional": false,
        "name": "core",
        "description": "Core reference"
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": true,
        "name": "options",
        "description": "Adapter options"
      }
    ],
    "return": {
      "types": [
        "{\"watch\": *, \"capabilities\": *, \"exists\": *, \"stat\": *, \"readdir\": *, \"readfile\": *, \"mkdir\": *, \"writefile\": *, \"rename\": *, \"copy\": *, \"unlink\": *, \"search\": *, \"touch\": *, \"realpath\": *}"
      ]
    }
  },
  {
    "__docId__": 62,
    "kind": "file",
    "name": "src/auth.js",
    "content": "/*\n * OS.js - JavaScript Cloud/Web Desktop Platform\n *\n * Copyright (c) Anders Evenrud <andersevenrud@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * @author  Anders Evenrud <andersevenrud@gmail.com>\n * @licence Simplified BSD License\n */\n\nconst fs = require('fs-extra');\nconst pathLib = require('path');\nconst consola = require('consola');\nconst logger = consola.withTag('Auth');\nconst nullAdapter = require('./adapters/auth/null.js');\n\n/**\n * TODO: typedef\n * @typedef {Object} AuthAdapter\n */\n\n/**\n * Authentication User Profile\n * @typedef {Object} AuthUserProfile\n * @property {number} id\n * @property {string} username\n * @property {string} name\n * @property {string[]} groups\n */\n\n/**\n * Authentication Service Options\n * @typedef {Object} AuthOptions\n * @property {AuthAdapter} [adapter]\n * @property {string[]} [requiredGroups]\n * @property {string[]} [denyUsers]\n */\n\n/**\n * Authentication Handler\n */\nclass Auth {\n\n  /**\n   * Creates a new instance\n   * @param {Core} core Core instance reference\n   * @param {AuthOptions} [options={}] Service Provider arguments\n   */\n  constructor(core, options = {}) {\n    const {requiredGroups, denyUsers} = core.configuration.auth;\n\n    /**\n     * @type {Core}\n     */\n    this.core = core;\n\n    /**\n     * @type {AuthOptions}\n     */\n    this.options = {\n      adapter: nullAdapter,\n      requiredGroups,\n      denyUsers,\n      ...options\n    };\n\n    /**\n     * @type {AuthAdapter}\n     */\n    this.adapter = nullAdapter(core, this.options.config);\n\n    try {\n      this.adapter = this.options.adapter(core, this.options.config);\n    } catch (e) {\n      this.core.logger.warn(e);\n    }\n  }\n\n  /**\n   * Destroys instance\n   */\n  destroy() {\n    if (this.adapter.destroy) {\n      this.adapter.destroy();\n    }\n  }\n\n  /**\n   * Initializes adapter\n   * @return {Promise<boolean>}\n   */\n  async init() {\n    if (this.adapter.init) {\n      return this.adapter.init();\n    }\n\n    return true;\n  }\n\n  /**\n   * Performs a login request\n   * @param {Request} req HTTP request\n   * @param {Response} res HTTP response\n   * @return {Promise<undefined>}\n   */\n  async login(req, res) {\n    const result = await this.adapter.login(req, res);\n\n    if (result) {\n      const profile = this.createUserProfile(req.body, result);\n\n      if (profile && this.checkLoginPermissions(profile)) {\n        await this.createHomeDirectory(profile, req, res);\n        req.session.user = profile;\n        req.session.save(() => {\n          this.core.emit('osjs/core:logged-in', Object.freeze({\n            ...req.session\n          }));\n\n          res.status(200).json(profile);\n        });\n        return;\n      }\n    }\n\n    res.status(403)\n      .json({error: 'Invalid login or permission denied'});\n  }\n\n  /**\n   * Performs a logout request\n   * @param {Request} req HTTP request\n   * @param {Response} res HTTP response\n   * @return {Promise<undefined>}\n   */\n  async logout(req, res) {\n    this.core.emit('osjs/core:logging-out', Object.freeze({\n      ...req.session\n    }));\n\n    await this.adapter.logout(req, res);\n\n    try {\n      req.session.destroy();\n    } catch (e) {\n      logger.warn(e);\n    }\n\n    res.json({});\n  }\n\n  /**\n   * Performs a register request\n   * @param {Request} req HTTP request\n   * @param {Response} res HTTP response\n   * @return {Promise<undefined>}\n   */\n  async register(req, res) {\n    if (this.adapter.register) {\n      const result = await this.adapter.register(req, res);\n\n      return res.json(result);\n    }\n\n    return res.status(403)\n      .json({error: 'Registration unavailable'});\n  }\n\n  /**\n   * Checks if login is allowed for this user\n   * @param {AuthUserProfile} profile User profile\n   * @return {boolean}\n   */\n  checkLoginPermissions(profile) {\n    const {requiredGroups, denyUsers} = this.options;\n\n    if (denyUsers.indexOf(profile.username) !== -1) {\n      return false;\n    }\n\n    if (requiredGroups.length > 0) {\n      const passes = requiredGroups.every(name => {\n        return profile.groups.indexOf(name) !== -1;\n      });\n\n      return passes;\n    }\n\n    return true;\n  }\n\n  /**\n   * Creates user profile object\n   * @param {object} fields Input fields\n   * @param {object} result Login result\n   * @return {AuthUserProfile|boolean}\n   */\n  createUserProfile(fields, result) {\n    const ignores = ['password'];\n    const required = ['username', 'id'];\n    const template = {\n      id: 0,\n      username: fields.username,\n      name: fields.username,\n      groups: this.core.config('auth.defaultGroups', [])\n    };\n\n    const missing = required\n      .filter(k => typeof result[k] === 'undefined');\n\n    if (missing.length) {\n      logger.warn('Missing user attributes', missing);\n    } else {\n      const values = Object.keys(result)\n        .filter(k => ignores.indexOf(k) === -1)\n        .reduce((o, k) => ({...o, [k]: result[k]}), {});\n\n      return {...template, ...values};\n    }\n\n    return false;\n  }\n\n  /**\n   * Tries to create home directory for a user\n   * @param {AuthUserProfile} profile User profile\n   * @return {Promise<undefined>}\n   */\n  async createHomeDirectory(profile) {\n    const vfs = this.core.make('osjs/vfs');\n    const template = this.core.config('vfs.home.template', []);\n\n    if (typeof template === 'string') {\n      // If the template is a string, it is a path to a directory\n      // that should be copied to the user's home directory\n      const root = await vfs.realpath('home:/', profile);\n\n      await fs.copy(template, root, {overwrite: false});\n    } else if (Array.isArray(template)) {\n      await this.createHomeDirectoryFromArray(template, vfs, profile);\n    }\n  }\n\n  /**\n   * If the template is an array, it is a list of files that should be copied\n   * to the user's home directory\n   * @param {Object[]} template Array of objects with a specified path,\n   * optionally with specified content but defaulting to an empty string\n   * @param {VFSServiceProvider} vfs An instance of the virtual file system\n   * @param {AuthUserProfile} profile User profile\n   */\n  async createHomeDirectoryFromArray(template, vfs, profile) {\n    for (const file of template) {\n      try {\n        const {path, contents = ''} = file;\n        const shortcutsFile = await vfs.realpath(`home:/${path}`, profile);\n        const dir = pathLib.dirname(shortcutsFile);\n\n        if (!await fs.pathExists(shortcutsFile)) {\n          await fs.ensureDir(dir);\n          await fs.writeFile(shortcutsFile, contents);\n        }\n      } catch (e) {\n        console.warn(`There was a problem writing '${file.path}' to the home directory template`);\n        console.error('ERROR:', e);\n      }\n    }\n  }\n}\n\nmodule.exports = Auth;\n",
    "static": true,
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/src/auth.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 63,
    "kind": "variable",
    "name": "logger",
    "memberof": "src/auth.js",
    "static": true,
    "longname": "src/auth.js~logger",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/auth.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 34,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 64,
    "kind": "typedef",
    "name": "AuthAdapter",
    "memberof": "src/auth.js",
    "static": true,
    "longname": "src/auth.js~AuthAdapter",
    "access": "public",
    "description": "TODO: typedef",
    "type": {
      "types": [
        "Object"
      ],
      "optional": false,
      "name": "AuthAdapter"
    }
  },
  {
    "__docId__": 65,
    "kind": "typedef",
    "name": "AuthUserProfile",
    "memberof": "src/auth.js",
    "static": true,
    "longname": "src/auth.js~AuthUserProfile",
    "access": "public",
    "description": "Authentication User Profile",
    "properties": [
      {
        "nullable": null,
        "types": [
          "number"
        ],
        "spread": false,
        "optional": false,
        "name": "id",
        "description": ""
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "username",
        "description": ""
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "name",
        "description": ""
      },
      {
        "nullable": null,
        "types": [
          "string[]"
        ],
        "spread": false,
        "optional": false,
        "name": "groups",
        "description": ""
      }
    ],
    "type": {
      "types": [
        "Object"
      ],
      "optional": false,
      "name": "AuthUserProfile"
    }
  },
  {
    "__docId__": 66,
    "kind": "typedef",
    "name": "AuthOptions",
    "memberof": "src/auth.js",
    "static": true,
    "longname": "src/auth.js~AuthOptions",
    "access": "public",
    "description": "Authentication Service Options",
    "properties": [
      {
        "nullable": null,
        "types": [
          "AuthAdapter"
        ],
        "spread": false,
        "optional": true,
        "name": "adapter",
        "description": ""
      },
      {
        "nullable": null,
        "types": [
          "string[]"
        ],
        "spread": false,
        "optional": true,
        "name": "requiredGroups",
        "description": ""
      },
      {
        "nullable": null,
        "types": [
          "string[]"
        ],
        "spread": false,
        "optional": true,
        "name": "denyUsers",
        "description": ""
      }
    ],
    "type": {
      "types": [
        "Object"
      ],
      "optional": false,
      "name": "AuthOptions"
    }
  },
  {
    "__docId__": 67,
    "kind": "class",
    "name": "Auth",
    "memberof": "src/auth.js",
    "static": true,
    "longname": "src/auth.js~Auth",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/auth.js",
    "importStyle": "Auth",
    "description": "Authentication Handler",
    "lineNumber": 62,
    "interface": false
  },
  {
    "__docId__": 68,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "src/auth.js~Auth",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/auth.js~Auth#constructor",
    "access": "public",
    "description": "Creates a new instance",
    "lineNumber": 69,
    "params": [
      {
        "nullable": null,
        "types": [
          "Core"
        ],
        "spread": false,
        "optional": false,
        "name": "core",
        "description": "Core instance reference"
      },
      {
        "nullable": null,
        "types": [
          "AuthOptions"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "{}",
        "defaultRaw": {},
        "name": "options",
        "description": "Service Provider arguments"
      }
    ]
  },
  {
    "__docId__": 69,
    "kind": "member",
    "name": "core",
    "memberof": "src/auth.js~Auth",
    "static": false,
    "longname": "src/auth.js~Auth#core",
    "access": "public",
    "description": "",
    "lineNumber": 75,
    "type": {
      "nullable": null,
      "types": [
        "Core"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 70,
    "kind": "member",
    "name": "options",
    "memberof": "src/auth.js~Auth",
    "static": false,
    "longname": "src/auth.js~Auth#options",
    "access": "public",
    "description": "",
    "lineNumber": 80,
    "type": {
      "nullable": null,
      "types": [
        "AuthOptions"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 71,
    "kind": "member",
    "name": "adapter",
    "memberof": "src/auth.js~Auth",
    "static": false,
    "longname": "src/auth.js~Auth#adapter",
    "access": "public",
    "description": "",
    "lineNumber": 90,
    "type": {
      "nullable": null,
      "types": [
        "AuthAdapter"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 73,
    "kind": "method",
    "name": "destroy",
    "memberof": "src/auth.js~Auth",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/auth.js~Auth#destroy",
    "access": "public",
    "description": "Destroys instance",
    "lineNumber": 102,
    "params": [],
    "return": null
  },
  {
    "__docId__": 74,
    "kind": "method",
    "name": "init",
    "memberof": "src/auth.js~Auth",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/auth.js~Auth#init",
    "access": "public",
    "description": "Initializes adapter",
    "lineNumber": 112,
    "return": {
      "nullable": null,
      "types": [
        "Promise<boolean>"
      ],
      "spread": false,
      "description": ""
    },
    "params": []
  },
  {
    "__docId__": 75,
    "kind": "method",
    "name": "login",
    "memberof": "src/auth.js~Auth",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/auth.js~Auth#login",
    "access": "public",
    "description": "Performs a login request",
    "lineNumber": 126,
    "params": [
      {
        "nullable": null,
        "types": [
          "Request"
        ],
        "spread": false,
        "optional": false,
        "name": "req",
        "description": "HTTP request"
      },
      {
        "nullable": null,
        "types": [
          "Response"
        ],
        "spread": false,
        "optional": false,
        "name": "res",
        "description": "HTTP response"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise<undefined>"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 76,
    "kind": "method",
    "name": "logout",
    "memberof": "src/auth.js~Auth",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/auth.js~Auth#logout",
    "access": "public",
    "description": "Performs a logout request",
    "lineNumber": 156,
    "params": [
      {
        "nullable": null,
        "types": [
          "Request"
        ],
        "spread": false,
        "optional": false,
        "name": "req",
        "description": "HTTP request"
      },
      {
        "nullable": null,
        "types": [
          "Response"
        ],
        "spread": false,
        "optional": false,
        "name": "res",
        "description": "HTTP response"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise<undefined>"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 77,
    "kind": "method",
    "name": "register",
    "memberof": "src/auth.js~Auth",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/auth.js~Auth#register",
    "access": "public",
    "description": "Performs a register request",
    "lineNumber": 178,
    "params": [
      {
        "nullable": null,
        "types": [
          "Request"
        ],
        "spread": false,
        "optional": false,
        "name": "req",
        "description": "HTTP request"
      },
      {
        "nullable": null,
        "types": [
          "Response"
        ],
        "spread": false,
        "optional": false,
        "name": "res",
        "description": "HTTP response"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise<undefined>"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 78,
    "kind": "method",
    "name": "checkLoginPermissions",
    "memberof": "src/auth.js~Auth",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/auth.js~Auth#checkLoginPermissions",
    "access": "public",
    "description": "Checks if login is allowed for this user",
    "lineNumber": 194,
    "params": [
      {
        "nullable": null,
        "types": [
          "AuthUserProfile"
        ],
        "spread": false,
        "optional": false,
        "name": "profile",
        "description": "User profile"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 79,
    "kind": "method",
    "name": "createUserProfile",
    "memberof": "src/auth.js~Auth",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/auth.js~Auth#createUserProfile",
    "access": "public",
    "description": "Creates user profile object",
    "lineNumber": 218,
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "fields",
        "description": "Input fields"
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "result",
        "description": "Login result"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "AuthUserProfile",
        "boolean"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 80,
    "kind": "method",
    "name": "createHomeDirectory",
    "memberof": "src/auth.js~Auth",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/auth.js~Auth#createHomeDirectory",
    "access": "public",
    "description": "Tries to create home directory for a user",
    "lineNumber": 249,
    "params": [
      {
        "nullable": null,
        "types": [
          "AuthUserProfile"
        ],
        "spread": false,
        "optional": false,
        "name": "profile",
        "description": "User profile"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise<undefined>"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 81,
    "kind": "method",
    "name": "createHomeDirectoryFromArray",
    "memberof": "src/auth.js~Auth",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/auth.js~Auth#createHomeDirectoryFromArray",
    "access": "public",
    "description": "If the template is an array, it is a list of files that should be copied\nto the user's home directory",
    "lineNumber": 272,
    "params": [
      {
        "nullable": null,
        "types": [
          "Object[]"
        ],
        "spread": false,
        "optional": false,
        "name": "template",
        "description": "Array of objects with a specified path,\noptionally with specified content but defaulting to an empty string"
      },
      {
        "nullable": null,
        "types": [
          "VFSServiceProvider"
        ],
        "spread": false,
        "optional": false,
        "name": "vfs",
        "description": "An instance of the virtual file system"
      },
      {
        "nullable": null,
        "types": [
          "AuthUserProfile"
        ],
        "spread": false,
        "optional": false,
        "name": "profile",
        "description": "User profile"
      }
    ],
    "return": null
  },
  {
    "__docId__": 82,
    "kind": "file",
    "name": "src/config.js",
    "content": "/*\n * OS.js - JavaScript Cloud/Web Desktop Platform\n *\n * Copyright (c) Anders Evenrud <andersevenrud@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * @author  Anders Evenrud <andersevenrud@gmail.com>\n * @licence Simplified BSD License\n */\n\nconst path = require('path');\nconst maxAge = 60 * 60 * 12;\nconst mb = m => m * 1024 * 1024;\n\nconst defaultConfiguration = {\n  development: !(process.env.NODE_ENV || '').match(/^prod/i),\n  logging: true,\n  index: 'index.html',\n  bind: '0.0.0.0',\n  port: 8000,\n  public: null,\n  morgan: 'tiny',\n  express: {\n    maxFieldsSize: mb(20),\n    maxFileSize: mb(200),\n    maxBodySize: '100kb'\n  },\n  https: {\n    enabled: false,\n    options: {\n      key: null,\n      cert: null\n    }\n  },\n  ws: {\n    port: null,\n    ping: 30 * 1000\n  },\n  proxy: [\n    /*\n    {\n      source: 'pattern',\n      destination: 'pattern',\n      options: {}\n    }\n    */\n  ],\n  auth: {\n    vfsGroups: [],\n    defaultGroups: [],\n    requiredGroups: [],\n    requireAllGroups: false,\n    denyUsers: []\n  },\n  mime: {\n    filenames: {\n      // 'filename': 'mime/type'\n      'Makefile': 'text/x-makefile',\n      '.gitignore': 'text/plain'\n    },\n    define: {\n      // 'mime/type': ['ext']\n      'text/x-lilypond': ['ly', 'ily'],\n      'text/x-python': ['py'],\n      'application/tar+gzip': ['tgz']\n    }\n  },\n  session: {\n    store: {\n      module: require.resolve('connect-loki'),\n      options: {\n        autosave: true\n        // ttl: maxAge\n      }\n    },\n    options: {\n      name: 'osjs.sid',\n      secret: 'osjs',\n      rolling: true,\n      resave: false,\n      saveUninitialized: false,\n      cookie: {\n        secure: 'auto',\n        maxAge: 1000 * maxAge\n      }\n    }\n  },\n  packages: {\n    // Resolves to root by default\n    discovery: 'packages.json',\n\n    // Resolves to dist/ by default\n    metadata: 'metadata.json'\n  },\n\n  vfs: {\n    watch: false,\n    root: path.join(process.cwd(), 'vfs'),\n\n    mountpoints: [{\n      name: 'osjs',\n      attributes: {\n        root: '{root}/dist',\n        readOnly: true\n      }\n    }, {\n      name: 'home',\n      attributes: {\n        root: '{vfs}/{username}'\n      }\n    }],\n\n    home: {\n      template: [{\n        path: '.desktop/.shortcuts.json',\n        contents: JSON.stringify([])\n      }]\n    }\n  }\n};\n\nmodule.exports = {\n  defaultConfiguration\n};\n\n",
    "static": true,
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/src/config.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 83,
    "kind": "variable",
    "name": "maxAge",
    "memberof": "src/config.js",
    "static": true,
    "longname": "src/config.js~maxAge",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/config.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 32,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 84,
    "kind": "function",
    "name": "mb",
    "memberof": "src/config.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/config.js~mb",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/config.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 33,
    "undocument": true,
    "params": [
      {
        "name": "m",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 85,
    "kind": "variable",
    "name": "defaultConfiguration",
    "memberof": "src/config.js",
    "static": true,
    "longname": "src/config.js~defaultConfiguration",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/config.js",
    "importStyle": "{defaultConfiguration}",
    "description": null,
    "lineNumber": 35,
    "undocument": true,
    "type": {
      "types": [
        "{\"development\": *, \"logging\": boolean, \"index\": string, \"bind\": string, \"port\": number, \"public\": *, \"morgan\": string, \"express\": *, \"https\": *, \"ws\": *, \"proxy\": *, \"auth\": *, \"mime\": *, \"session\": *, \"packages\": *, \"vfs\": *}"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 86,
    "kind": "file",
    "name": "src/core.js",
    "content": "/*\n * OS.js - JavaScript Cloud/Web Desktop Platform\n *\n * Copyright (c) Anders Evenrud <andersevenrud@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * @author  Anders Evenrud <andersevenrud@gmail.com>\n * @licence Simplified BSD License\n */\n\nconst fs = require('fs-extra');\nconst http = require('http');\nconst https = require('https');\nconst path = require('path');\nconst morgan = require('morgan');\nconst express = require('express');\nconst minimist = require('minimist');\nconst deepmerge = require('deepmerge');\nconst consola = require('consola');\nconst {CoreBase} = require('@osjs/common');\nconst {argvToConfig, createSession, createWebsocket, parseJson} = require('./utils/core.js');\nconst {defaultConfiguration} = require('./config.js');\nconst logger = consola.withTag('Core');\n\nlet _instance;\n\n/**\n * OS.js Server Core\n */\nclass Core extends CoreBase {\n\n  /**\n   * Creates a new instance\n   * @param {Object} cfg Configuration tree\n   * @param {Object} [options] Options\n   */\n  constructor(cfg, options = {}) {\n    options = {\n      argv: process.argv.splice(2),\n      root: process.cwd(),\n      ...options\n    };\n\n    const argv = minimist(options.argv);\n    const val = k => argvToConfig[k](parseJson(argv[k]));\n    const keys = Object.keys(argvToConfig).filter(k => Object.prototype.hasOwnProperty.call(argv, k));\n    const argvConfig = keys.reduce((o, k) => {\n      logger.info(`CLI argument '--${k}' overrides`, val(k));\n      return {...o, ...deepmerge(o, val(k))};\n    }, {});\n\n    super(defaultConfiguration, deepmerge(cfg, argvConfig), options);\n\n    this.logger = consola.withTag('Internal');\n\n    /**\n     * @type {Express}\n     */\n    this.app = express();\n\n    if (!this.configuration.public) {\n      throw new Error('The public option is required');\n    }\n\n    /**\n     * @type {http.Server|https.Server}\n     */\n    this.httpServer = this.config('https.enabled')\n      ? https.createServer(this.config('https.options'), this.app)\n      : http.createServer(this.app);\n\n    /**\n     * @type {object}\n     */\n    this.session = createSession(this.app, this.configuration);\n\n    /**\n     * @type {object}\n     */\n    this.ws = createWebsocket(this.app, this.configuration, this.session, this.httpServer);\n\n    /**\n     * @type {object}\n     */\n    this.wss = this.ws.getWss();\n\n    _instance = this;\n  }\n\n  /**\n   * Destroys the instance\n   * @param {Function} [done] Callback when done\n   * @return {Promise<undefined>}\n   */\n  async destroy(done = () => {}) {\n    if (this.destroyed) {\n      return;\n    }\n\n    this.emit('osjs/core:destroy');\n\n    logger.info('Shutting down...');\n\n    if (this.wss) {\n      this.wss.close();\n    }\n\n    const finish = (error) => {\n      if (error) {\n        logger.error(error);\n      }\n\n      if (this.httpServer) {\n        this.httpServer.close(done);\n      } else {\n        done();\n      }\n    };\n\n    try {\n      await super.destroy();\n      finish();\n    } catch (e) {\n      finish(e);\n    }\n  }\n\n  /**\n   * Starts the server\n   * @return {Promise<boolean>}\n   */\n  async start() {\n    if (!this.started) {\n      logger.info('Starting services...');\n\n      await super.start();\n\n      logger.success('Initialized!');\n\n      await this.listen();\n    }\n\n    return true;\n  }\n\n  /**\n   * Initializes the server\n   * @return {Promise<boolean>}\n   */\n  async boot() {\n    if (this.booted) {\n      return true;\n    }\n\n    this.emit('osjs/core:start');\n\n    if (this.configuration.logging) {\n      this.wss.on('connection', (c) => {\n        logger.log('WebSocket connection opened');\n        c.on('close', () => logger.log('WebSocket connection closed'));\n      });\n\n      if (this.configuration.morgan) {\n        this.app.use(morgan(this.configuration.morgan));\n      }\n    }\n\n\n    logger.info('Initializing services...');\n\n    await super.boot();\n    this.emit('init');\n    await this.start();\n    this.emit('osjs/core:started');\n\n    return true;\n  }\n\n  /**\n   * Opens HTTP server\n   */\n  async listen() {\n    const httpPort = this.config('port');\n    const httpHost = this.config('bind');\n    const wsPort = this.config('ws.port') || httpPort;\n    const pub = this.config('public');\n    const session = path.basename(path.dirname(this.config('session.store.module')));\n    const dist = pub.replace(process.cwd(), '');\n    const secure = this.config('https.enabled', false);\n    const proto = prefix => `${prefix}${secure ? 's' : ''}://`;\n    const host = port => `${httpHost}:${port}`;\n\n    logger.info('Opening server connection');\n\n    const checkFile = path.join(pub, this.configuration.index);\n    if (!fs.existsSync(checkFile)) {\n      logger.warn('Missing files in \"dist/\" directory. Did you forget to run \"npm run build\" ?');\n    }\n\n    return new Promise((resolve, reject) => {\n      try {\n        this.httpServer.listen(httpPort, httpHost, (e) => {\n          if (e) {\n            reject(e);\n          } else {\n            logger.success(`Using '${session}' sessions`);\n            logger.success(`Serving '${dist}'`);\n            logger.success(`WebSocket listening on ${proto('ws')}${host(wsPort)}`);\n            logger.success(`Server listening on ${proto('http')}${host(httpPort)}`);\n            resolve();\n          }\n        });\n      } catch (e) {\n        reject(e);\n      }\n    });\n  }\n\n  /**\n   * Broadcast given event to client\n   * @param {string} name Event name\n   * @param {Array} params A list of parameters to send to client\n   * @param {Function} [filter] A function to filter clients\n   */\n  broadcast(name, params, filter) {\n    filter = filter || (() => true);\n\n    if (this.ws) {\n      this.wss.clients // This is a Set\n        .forEach(client => {\n          if (!client._osjs_client) {\n            return;\n          }\n\n          if (filter(client)) {\n            client.send(JSON.stringify({\n              params,\n              name\n            }));\n          }\n        });\n    }\n  }\n\n  /**\n   * Broadcast given event to all clients\n   * @param {string} name Event name\n   * @param {Array} ...params A list of parameters to send to client\n   */\n  broadcastAll(name, ...params) {\n    return this.broadcast(name, params);\n  }\n\n  /**\n   * Broadcast given event to client filtered by username\n   * @param {String} username Username to send to\n   * @param {string} name Event name\n   * @param {Array} ...params A list of parameters to send to client\n   */\n  broadcastUser(username, name, ...params) {\n    return this.broadcast(name, params, client => {\n      return client._osjs_client.username === username;\n    });\n  }\n\n  /**\n   * Gets the server instance\n   * @return {Core}\n   */\n  static getInstance() {\n    return _instance;\n  }\n}\n\nmodule.exports = Core;\n",
    "static": true,
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/src/core.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 87,
    "kind": "variable",
    "name": "CoreBase",
    "memberof": "src/core.js",
    "static": true,
    "longname": "src/core.js~CoreBase",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/core.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 41,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 88,
    "kind": "variable",
    "name": "argvToConfig",
    "memberof": "src/core.js",
    "static": true,
    "longname": "src/core.js~argvToConfig",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/core.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 43,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 89,
    "kind": "variable",
    "name": "defaultConfiguration",
    "memberof": "src/core.js",
    "static": true,
    "longname": "src/core.js~defaultConfiguration",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/core.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 45,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 90,
    "kind": "variable",
    "name": "logger",
    "memberof": "src/core.js",
    "static": true,
    "longname": "src/core.js~logger",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/core.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 46,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 91,
    "kind": "class",
    "name": "Core",
    "memberof": "src/core.js",
    "static": true,
    "longname": "src/core.js~Core",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/core.js",
    "importStyle": "Core",
    "description": "OS.js Server Core",
    "lineNumber": 53,
    "interface": false,
    "extends": [
      "CoreBase"
    ]
  },
  {
    "__docId__": 92,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "src/core.js~Core",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/core.js~Core#constructor",
    "access": "public",
    "description": "Creates a new instance",
    "lineNumber": 60,
    "params": [
      {
        "nullable": null,
        "types": [
          "Object"
        ],
        "spread": false,
        "optional": false,
        "name": "cfg",
        "description": "Configuration tree"
      },
      {
        "nullable": null,
        "types": [
          "Object"
        ],
        "spread": false,
        "optional": true,
        "name": "options",
        "description": "Options"
      }
    ]
  },
  {
    "__docId__": 93,
    "kind": "member",
    "name": "logger",
    "memberof": "src/core.js~Core",
    "static": false,
    "longname": "src/core.js~Core#logger",
    "access": "public",
    "description": null,
    "lineNumber": 77,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 94,
    "kind": "member",
    "name": "app",
    "memberof": "src/core.js~Core",
    "static": false,
    "longname": "src/core.js~Core#app",
    "access": "public",
    "description": "",
    "lineNumber": 82,
    "type": {
      "nullable": null,
      "types": [
        "Express"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 95,
    "kind": "member",
    "name": "httpServer",
    "memberof": "src/core.js~Core",
    "static": false,
    "longname": "src/core.js~Core#httpServer",
    "access": "public",
    "description": "",
    "lineNumber": 91,
    "type": {
      "nullable": null,
      "types": [
        "http.Server",
        "https.Server"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 96,
    "kind": "member",
    "name": "session",
    "memberof": "src/core.js~Core",
    "static": false,
    "longname": "src/core.js~Core#session",
    "access": "public",
    "description": "",
    "lineNumber": 98,
    "type": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 97,
    "kind": "member",
    "name": "ws",
    "memberof": "src/core.js~Core",
    "static": false,
    "longname": "src/core.js~Core#ws",
    "access": "public",
    "description": "",
    "lineNumber": 103,
    "type": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 98,
    "kind": "member",
    "name": "wss",
    "memberof": "src/core.js~Core",
    "static": false,
    "longname": "src/core.js~Core#wss",
    "access": "public",
    "description": "",
    "lineNumber": 108,
    "type": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 99,
    "kind": "method",
    "name": "destroy",
    "memberof": "src/core.js~Core",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/core.js~Core#destroy",
    "access": "public",
    "description": "Destroys the instance",
    "lineNumber": 118,
    "params": [
      {
        "nullable": null,
        "types": [
          "Function"
        ],
        "spread": false,
        "optional": true,
        "name": "done",
        "description": "Callback when done"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise<undefined>"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 100,
    "kind": "method",
    "name": "start",
    "memberof": "src/core.js~Core",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/core.js~Core#start",
    "access": "public",
    "description": "Starts the server",
    "lineNumber": 155,
    "return": {
      "nullable": null,
      "types": [
        "Promise<boolean>"
      ],
      "spread": false,
      "description": ""
    },
    "params": []
  },
  {
    "__docId__": 101,
    "kind": "method",
    "name": "boot",
    "memberof": "src/core.js~Core",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/core.js~Core#boot",
    "access": "public",
    "description": "Initializes the server",
    "lineNumber": 173,
    "return": {
      "nullable": null,
      "types": [
        "Promise<boolean>"
      ],
      "spread": false,
      "description": ""
    },
    "params": []
  },
  {
    "__docId__": 102,
    "kind": "method",
    "name": "listen",
    "memberof": "src/core.js~Core",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/core.js~Core#listen",
    "access": "public",
    "description": "Opens HTTP server",
    "lineNumber": 205,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 103,
    "kind": "method",
    "name": "broadcast",
    "memberof": "src/core.js~Core",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/core.js~Core#broadcast",
    "access": "public",
    "description": "Broadcast given event to client",
    "lineNumber": 248,
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "name",
        "description": "Event name"
      },
      {
        "nullable": null,
        "types": [
          "Array"
        ],
        "spread": false,
        "optional": false,
        "name": "params",
        "description": "A list of parameters to send to client"
      },
      {
        "nullable": null,
        "types": [
          "Function"
        ],
        "spread": false,
        "optional": true,
        "name": "filter",
        "description": "A function to filter clients"
      }
    ],
    "return": null
  },
  {
    "__docId__": 104,
    "kind": "method",
    "name": "broadcastAll",
    "memberof": "src/core.js~Core",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/core.js~Core#broadcastAll",
    "access": "public",
    "description": "Broadcast given event to all clients",
    "lineNumber": 273,
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "name",
        "description": "Event name"
      },
      {
        "nullable": null,
        "types": [
          "Array"
        ],
        "spread": false,
        "optional": false,
        "name": "...params",
        "description": "A list of parameters to send to client"
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 105,
    "kind": "method",
    "name": "broadcastUser",
    "memberof": "src/core.js~Core",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/core.js~Core#broadcastUser",
    "access": "public",
    "description": "Broadcast given event to client filtered by username",
    "lineNumber": 283,
    "params": [
      {
        "nullable": null,
        "types": [
          "String"
        ],
        "spread": false,
        "optional": false,
        "name": "username",
        "description": "Username to send to"
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "name",
        "description": "Event name"
      },
      {
        "nullable": null,
        "types": [
          "Array"
        ],
        "spread": false,
        "optional": false,
        "name": "...params",
        "description": "A list of parameters to send to client"
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 106,
    "kind": "method",
    "name": "getInstance",
    "memberof": "src/core.js~Core",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/core.js~Core.getInstance",
    "access": "public",
    "description": "Gets the server instance",
    "lineNumber": 293,
    "return": {
      "nullable": null,
      "types": [
        "Core"
      ],
      "spread": false,
      "description": ""
    },
    "params": []
  },
  {
    "__docId__": 107,
    "kind": "file",
    "name": "src/filesystem.js",
    "content": "/*\n * OS.js - JavaScript Cloud/Web Desktop Platform\n *\n * Copyright (c) Anders Evenrud <andersevenrud@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * @author  Anders Evenrud <andersevenrud@gmail.com>\n * @licence Simplified BSD License\n */\n\nconst {methodArguments} = require('./utils/vfs');\nconst systemAdapter = require('./adapters/vfs/system');\nconst {v1: uuid} = require('uuid');\nconst mime = require('mime');\nconst path = require('path');\nconst vfs = require('./vfs');\nconst {closeWatches} = require('./utils/core.js');\nconst consola = require('consola');\nconst logger = consola.withTag('Filesystem');\n\n/**\n * @typedef {Object} Mountpoint\n * @property {string} [uuid]\n * @property {string} [root]\n * @property {object} [attributes]\n */\n\n/**\n * TODO: typedef\n * @typedef {Object} FilesystemAdapter\n */\n\n/**\n * Filesystem Service Adapter Option Map\n * @typedef {{name: FilesystemAdapter}} FilesystemAdapterMap\n */\n\n/**\n * Filesystem Service Options\n * @typedef {Object} FilesystemOptions\n * @property {FilesystemAdapterMap} [adapters]\n */\n\n/**\n * Filesystem Internal Call Options\n * @typedef {Object} FilesystemCallOptions\n * @property {string} method VFS Method name\n * @property {object} [user] User session data\n * @property {object} [session] Session data\n */\n\n/**\n * OS.js Virtual Filesystem\n */\nclass Filesystem {\n\n  /**\n   * Create new instance\n   * @param {Core} core Core reference\n   * @param {FilesystemOptions} [options] Instance options\n   */\n  constructor(core, options = {}) {\n    /**\n     * @type {Core}\n     */\n    this.core = core;\n\n    /**\n     * @type {Mountpoint[]}\n     */\n    this.mountpoints = [];\n\n    /**\n     * @type {FilesystemAdapterMap}\n     */\n    this.adapters = {};\n\n    this.watches = [];\n\n    this.router = null;\n\n    this.methods = {};\n\n    /**\n     * @type {FilesystemOptions}\n     */\n    this.options = {\n      adapters: {},\n      ...options\n    };\n  }\n\n  /**\n   * Destroys instance\n   * @return {Promise<undefined>}\n   */\n  async destroy() {\n    const watches = this.watches.filter(({watch}) => {\n      return watch && typeof watch.close === 'function';\n    }).map(({watch}) => watch);\n\n    await closeWatches(watches);\n\n    this.watches = [];\n  }\n\n  /**\n   * Initializes Filesystem\n   * @return {Promise<boolean>}\n   */\n  async init() {\n    const adapters = {\n      system: systemAdapter,\n      ...this.options.adapters\n    };\n\n    this.adapters = Object.keys(adapters).reduce((result, iter) => {\n      return {\n        [iter]: adapters[iter](this.core),\n        ...result\n      };\n    }, {});\n\n    // Routes\n    const {router, methods} = vfs(this.core);\n    this.router = router;\n    this.methods = methods;\n\n    // Mimes\n    const {define} = this.core.config('mime', {define: {}, filenames: {}});\n    mime.define(define, {force: true});\n\n    // Mountpoints\n    await Promise.all(this.core.config('vfs.mountpoints')\n      .map(mount => this.mount(mount)));\n\n    return true;\n  }\n\n  /**\n   * Gets MIME\n   * @param {string} filename Input filename or path\n   * @return {string}\n   */\n  mime(filename) {\n    const {filenames} = this.core.config('mime', {\n      define: {},\n      filenames: {}\n    });\n\n    return filenames[path.basename(filename)]\n      ? filenames[path.basename(filename)]\n      : mime.getType(filename) || 'application/octet-stream';\n  }\n\n  /**\n   * Crates a VFS request\n   * @param {Request|object} req HTTP Request object\n   * @param {Response|object} [res] HTTP Response object\n   * @return {Promise<*>}\n   */\n  request(name, req, res = {}) {\n    return this.methods[name](req, res);\n  }\n\n  /**\n   * Performs a VFS request with simulated HTTP request\n   * @param {FilesystemCallOptions} options Request options\n   * @param {*} ...args Arguments to pass to VFS method\n   * @return {Promise<*>}\n   */\n  call(options, ...args) {\n    const {method, user, session} = {\n      user: {},\n      session: null,\n      ...options\n    };\n\n    const req = methodArguments[method]\n      .reduce(({fields, files}, key, index) => {\n        const arg = args[index];\n        if (typeof key === 'function') {\n          files = Object.assign(key(arg), files);\n        } else {\n          fields = {\n            [key]: arg,\n            ...fields\n          };\n        }\n\n        return {fields, files};\n      }, {fields: {}, files: {}});\n\n    req.session = session ? session : {user};\n\n    return this.request(method, req);\n  }\n\n  /**\n   * Creates realpath VFS request\n   * @param {string} filename The path\n   * @param {AuthUserProfile} [user] User session object\n   * @return {Promise<string>}\n   */\n  realpath(filename, user = {}) {\n    return this.methods.realpath({\n      session: {\n        user: {\n          groups: [],\n          ...user\n        }\n      },\n      fields: {\n        path: filename\n      }\n    });\n  }\n\n  /**\n   * Mounts given mountpoint\n   * @param {Mountpoint} mount Mountpoint\n   * @return {Mountpoint} the mountpoint\n   */\n  async mount(mount) {\n    const mountpoint = {\n      id: uuid(),\n      root: `${mount.name}:/`,\n      attributes: {},\n      ...mount\n    };\n\n    this.mountpoints.push(mountpoint);\n\n    logger.success('Mounted', mountpoint.name);\n\n    await this.watch(mountpoint);\n\n    return mountpoint;\n  }\n\n  /**\n   * Unmounts given mountpoint\n   * @param {Mountpoint} mount Mountpoint\n   * @return {Promise<boolean>}\n   */\n  async unmount(mountpoint) {\n    const found = this.watches.find(w => w.id === mountpoint.id);\n\n    if (found && found.watch) {\n      await found.watch.close();\n    }\n\n    const index = this.mountpoints.indexOf(mountpoint);\n\n    if (index !== -1) {\n      this.mountpoints.splice(index, 1);\n\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Set up a watch for given mountpoint\n   * @param {Mountpoint} mountpoint The mountpoint\n   * @return {Promise<undefined>}\n   */\n  async watch(mountpoint) {\n    if (\n      !mountpoint.attributes.watch ||\n      this.core.config('vfs.watch') === false ||\n      !mountpoint.attributes.root\n    ) {\n      return;\n    }\n\n    const adapter = await (mountpoint.adapter\n      ? this.adapters[mountpoint.adapter]\n      : this.adapters.system);\n\n    if (typeof adapter.watch === 'function') {\n      await this._watch(mountpoint, adapter);\n    }\n  }\n\n  /**\n   * Internal method for setting up watch for given mountpoint adapter\n   * @param {Mountpoint} mountpoint The mountpoint\n   * @param {FilesystemAdapter} adapter The adapter\n   * @return {Promise<undefined>}\n   */\n  async _watch(mountpoint, adapter) {\n    const watch = await adapter.watch(mountpoint, (args, dir, type) => {\n      const target = mountpoint.name + ':/' + dir;\n      const keys = Object.keys(args);\n      const filter = keys.length === 0\n        ? () => true\n        : ws => keys.every(k => ws._osjs_client[k] === args[k]);\n\n      this.core.emit('osjs/vfs:watch:change', {\n        mountpoint,\n        target,\n        type\n      });\n\n      this.core.broadcast('osjs/vfs:watch:change', [{\n        path: target,\n        type\n      }, args], filter);\n    });\n\n    watch.on('error', error => logger.warn('Mountpoint watch error', error));\n\n    this.watches.push({\n      id: mountpoint.id,\n      watch\n    });\n\n    logger.info('Watching mountpoint', mountpoint.name);\n  }\n}\n\nmodule.exports = Filesystem;\n",
    "static": true,
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/src/filesystem.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 108,
    "kind": "variable",
    "name": "methodArguments",
    "memberof": "src/filesystem.js",
    "static": true,
    "longname": "src/filesystem.js~methodArguments",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/filesystem.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 32,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 109,
    "kind": "variable",
    "name": "closeWatches",
    "memberof": "src/filesystem.js",
    "static": true,
    "longname": "src/filesystem.js~closeWatches",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/filesystem.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 39,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 110,
    "kind": "variable",
    "name": "logger",
    "memberof": "src/filesystem.js",
    "static": true,
    "longname": "src/filesystem.js~logger",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/filesystem.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 41,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 111,
    "kind": "typedef",
    "name": "Mountpoint",
    "memberof": "src/filesystem.js",
    "static": true,
    "longname": "src/filesystem.js~Mountpoint",
    "access": "public",
    "description": "",
    "properties": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": true,
        "name": "uuid",
        "description": ""
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": true,
        "name": "root",
        "description": ""
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": true,
        "name": "attributes",
        "description": ""
      }
    ],
    "type": {
      "types": [
        "Object"
      ],
      "optional": false,
      "name": "Mountpoint"
    }
  },
  {
    "__docId__": 112,
    "kind": "typedef",
    "name": "FilesystemAdapter",
    "memberof": "src/filesystem.js",
    "static": true,
    "longname": "src/filesystem.js~FilesystemAdapter",
    "access": "public",
    "description": "TODO: typedef",
    "type": {
      "types": [
        "Object"
      ],
      "optional": false,
      "name": "FilesystemAdapter"
    }
  },
  {
    "__docId__": 113,
    "kind": "typedef",
    "name": "FilesystemAdapterMap",
    "memberof": "src/filesystem.js",
    "static": true,
    "longname": "src/filesystem.js~FilesystemAdapterMap",
    "access": "public",
    "description": "Filesystem Service Adapter Option Map",
    "type": {
      "types": [
        "{name: FilesystemAdapter}"
      ],
      "optional": false,
      "name": "FilesystemAdapterMap"
    }
  },
  {
    "__docId__": 114,
    "kind": "typedef",
    "name": "FilesystemOptions",
    "memberof": "src/filesystem.js",
    "static": true,
    "longname": "src/filesystem.js~FilesystemOptions",
    "access": "public",
    "description": "Filesystem Service Options",
    "properties": [
      {
        "nullable": null,
        "types": [
          "FilesystemAdapterMap"
        ],
        "spread": false,
        "optional": true,
        "name": "adapters",
        "description": ""
      }
    ],
    "type": {
      "types": [
        "Object"
      ],
      "optional": false,
      "name": "FilesystemOptions"
    }
  },
  {
    "__docId__": 115,
    "kind": "typedef",
    "name": "FilesystemCallOptions",
    "memberof": "src/filesystem.js",
    "static": true,
    "longname": "src/filesystem.js~FilesystemCallOptions",
    "access": "public",
    "description": "Filesystem Internal Call Options",
    "properties": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "method",
        "description": "VFS Method name"
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": true,
        "name": "user",
        "description": "User session data"
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": true,
        "name": "session",
        "description": "Session data"
      }
    ],
    "type": {
      "types": [
        "Object"
      ],
      "optional": false,
      "name": "FilesystemCallOptions"
    }
  },
  {
    "__docId__": 116,
    "kind": "class",
    "name": "Filesystem",
    "memberof": "src/filesystem.js",
    "static": true,
    "longname": "src/filesystem.js~Filesystem",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/filesystem.js",
    "importStyle": "Filesystem",
    "description": "OS.js Virtual Filesystem",
    "lineNumber": 77,
    "interface": false
  },
  {
    "__docId__": 117,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "src/filesystem.js~Filesystem",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/filesystem.js~Filesystem#constructor",
    "access": "public",
    "description": "Create new instance",
    "lineNumber": 84,
    "params": [
      {
        "nullable": null,
        "types": [
          "Core"
        ],
        "spread": false,
        "optional": false,
        "name": "core",
        "description": "Core reference"
      },
      {
        "nullable": null,
        "types": [
          "FilesystemOptions"
        ],
        "spread": false,
        "optional": true,
        "name": "options",
        "description": "Instance options"
      }
    ]
  },
  {
    "__docId__": 118,
    "kind": "member",
    "name": "core",
    "memberof": "src/filesystem.js~Filesystem",
    "static": false,
    "longname": "src/filesystem.js~Filesystem#core",
    "access": "public",
    "description": "",
    "lineNumber": 88,
    "type": {
      "nullable": null,
      "types": [
        "Core"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 119,
    "kind": "member",
    "name": "mountpoints",
    "memberof": "src/filesystem.js~Filesystem",
    "static": false,
    "longname": "src/filesystem.js~Filesystem#mountpoints",
    "access": "public",
    "description": "",
    "lineNumber": 93,
    "type": {
      "nullable": null,
      "types": [
        "Mountpoint[]"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 120,
    "kind": "member",
    "name": "adapters",
    "memberof": "src/filesystem.js~Filesystem",
    "static": false,
    "longname": "src/filesystem.js~Filesystem#adapters",
    "access": "public",
    "description": "",
    "lineNumber": 98,
    "type": {
      "nullable": null,
      "types": [
        "FilesystemAdapterMap"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 121,
    "kind": "member",
    "name": "watches",
    "memberof": "src/filesystem.js~Filesystem",
    "static": false,
    "longname": "src/filesystem.js~Filesystem#watches",
    "access": "public",
    "description": null,
    "lineNumber": 100,
    "undocument": true,
    "type": {
      "types": [
        "*[]"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 122,
    "kind": "member",
    "name": "router",
    "memberof": "src/filesystem.js~Filesystem",
    "static": false,
    "longname": "src/filesystem.js~Filesystem#router",
    "access": "public",
    "description": null,
    "lineNumber": 102,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 123,
    "kind": "member",
    "name": "methods",
    "memberof": "src/filesystem.js~Filesystem",
    "static": false,
    "longname": "src/filesystem.js~Filesystem#methods",
    "access": "public",
    "description": null,
    "lineNumber": 104,
    "undocument": true,
    "type": {
      "types": [
        "{}"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 124,
    "kind": "member",
    "name": "options",
    "memberof": "src/filesystem.js~Filesystem",
    "static": false,
    "longname": "src/filesystem.js~Filesystem#options",
    "access": "public",
    "description": "",
    "lineNumber": 109,
    "type": {
      "nullable": null,
      "types": [
        "FilesystemOptions"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 125,
    "kind": "method",
    "name": "destroy",
    "memberof": "src/filesystem.js~Filesystem",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/filesystem.js~Filesystem#destroy",
    "access": "public",
    "description": "Destroys instance",
    "lineNumber": 119,
    "return": {
      "nullable": null,
      "types": [
        "Promise<undefined>"
      ],
      "spread": false,
      "description": ""
    },
    "params": []
  },
  {
    "__docId__": 127,
    "kind": "method",
    "name": "init",
    "memberof": "src/filesystem.js~Filesystem",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/filesystem.js~Filesystem#init",
    "access": "public",
    "description": "Initializes Filesystem",
    "lineNumber": 133,
    "return": {
      "nullable": null,
      "types": [
        "Promise<boolean>"
      ],
      "spread": false,
      "description": ""
    },
    "params": []
  },
  {
    "__docId__": 131,
    "kind": "method",
    "name": "mime",
    "memberof": "src/filesystem.js~Filesystem",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/filesystem.js~Filesystem#mime",
    "access": "public",
    "description": "Gets MIME",
    "lineNumber": 167,
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "filename",
        "description": "Input filename or path"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 132,
    "kind": "method",
    "name": "request",
    "memberof": "src/filesystem.js~Filesystem",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/filesystem.js~Filesystem#request",
    "access": "public",
    "description": "Crates a VFS request",
    "lineNumber": 184,
    "params": [
      {
        "nullable": null,
        "types": [
          "Request",
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "req",
        "description": "HTTP Request object"
      },
      {
        "nullable": null,
        "types": [
          "Response",
          "object"
        ],
        "spread": false,
        "optional": true,
        "name": "res",
        "description": "HTTP Response object"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise<*>"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 133,
    "kind": "method",
    "name": "call",
    "memberof": "src/filesystem.js~Filesystem",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/filesystem.js~Filesystem#call",
    "access": "public",
    "description": "Performs a VFS request with simulated HTTP request",
    "lineNumber": 194,
    "params": [
      {
        "nullable": null,
        "types": [
          "FilesystemCallOptions"
        ],
        "spread": false,
        "optional": false,
        "name": "options",
        "description": "Request options"
      },
      {
        "nullable": null,
        "types": [
          "*"
        ],
        "spread": false,
        "optional": false,
        "name": "...args",
        "description": "Arguments to pass to VFS method"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise<*>"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 134,
    "kind": "method",
    "name": "realpath",
    "memberof": "src/filesystem.js~Filesystem",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/filesystem.js~Filesystem#realpath",
    "access": "public",
    "description": "Creates realpath VFS request",
    "lineNumber": 227,
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "filename",
        "description": "The path"
      },
      {
        "nullable": null,
        "types": [
          "AuthUserProfile"
        ],
        "spread": false,
        "optional": true,
        "name": "user",
        "description": "User session object"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise<string>"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 135,
    "kind": "method",
    "name": "mount",
    "memberof": "src/filesystem.js~Filesystem",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/filesystem.js~Filesystem#mount",
    "access": "public",
    "description": "Mounts given mountpoint",
    "lineNumber": 246,
    "params": [
      {
        "nullable": null,
        "types": [
          "Mountpoint"
        ],
        "spread": false,
        "optional": false,
        "name": "mount",
        "description": "Mountpoint"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Mountpoint"
      ],
      "spread": false,
      "description": "the mountpoint"
    }
  },
  {
    "__docId__": 136,
    "kind": "method",
    "name": "unmount",
    "memberof": "src/filesystem.js~Filesystem",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/filesystem.js~Filesystem#unmount",
    "access": "public",
    "description": "Unmounts given mountpoint",
    "lineNumber": 268,
    "params": [
      {
        "nullable": null,
        "types": [
          "Mountpoint"
        ],
        "spread": false,
        "optional": false,
        "name": "mount",
        "description": "Mountpoint"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise<boolean>"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 137,
    "kind": "method",
    "name": "watch",
    "memberof": "src/filesystem.js~Filesystem",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/filesystem.js~Filesystem#watch",
    "access": "public",
    "description": "Set up a watch for given mountpoint",
    "lineNumber": 291,
    "params": [
      {
        "nullable": null,
        "types": [
          "Mountpoint"
        ],
        "spread": false,
        "optional": false,
        "name": "mountpoint",
        "description": "The mountpoint"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise<undefined>"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 138,
    "kind": "method",
    "name": "_watch",
    "memberof": "src/filesystem.js~Filesystem",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/filesystem.js~Filesystem#_watch",
    "access": "private",
    "description": "Internal method for setting up watch for given mountpoint adapter",
    "lineNumber": 315,
    "params": [
      {
        "nullable": null,
        "types": [
          "Mountpoint"
        ],
        "spread": false,
        "optional": false,
        "name": "mountpoint",
        "description": "The mountpoint"
      },
      {
        "nullable": null,
        "types": [
          "FilesystemAdapter"
        ],
        "spread": false,
        "optional": false,
        "name": "adapter",
        "description": "The adapter"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise<undefined>"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 139,
    "kind": "file",
    "name": "src/package.js",
    "content": "/*\n * OS.js - JavaScript Cloud/Web Desktop Platform\n *\n * Copyright (c) Anders Evenrud <andersevenrud@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * @author  Anders Evenrud <andersevenrud@gmail.com>\n * @licence Simplified BSD License\n */\n\nconst path = require('path');\nconst chokidar = require('chokidar');\n\n/**\n * TODO: typedef\n * @typedef {Object} PackageMetadata\n */\n\n/**\n * Package Options\n * @typedef {Object} PackageOptions\n * @property {string} filename\n * @property {PackageMetadata} metadata\n */\n\n/**\n * OS.js Package Abstraction\n */\nclass Package {\n\n  /**\n   * Create new instance\n   * @param {Core} core Core reference\n   * @param {PackageOptions} [options] Instance options\n   */\n  constructor(core, options = {}) {\n    /**\n     * @type {Core}\n     */\n    this.core = core;\n\n    this.script = options.metadata.server\n      ? path.resolve(path.dirname(options.filename), options.metadata.server)\n      : null;\n\n    /**\n     * @type {string}\n     */\n    this.filename = options.filename;\n\n    /**\n     * @type {PackageMetadata}\n     */\n    this.metadata = options.metadata;\n\n    this.handler = null;\n\n    this.watcher = null;\n  }\n\n  /**\n   * Destroys instance\n   */\n  async destroy() {\n    this.action('destroy');\n\n    if (this.watcher) {\n      await this.watcher.close();\n      this.watcher = null;\n    }\n  }\n\n  /**\n   * Run method on package script\n   * @param {string} method Method name\n   * @param {*} [...args] Pass arguments\n   * @return {boolean}\n   */\n  action(method, ...args) {\n    try {\n      if (this.handler && typeof this.handler[method] === 'function') {\n        this.handler[method](...args);\n\n        return true;\n      }\n    } catch (e) {\n      this.core.logger.warn(e);\n    }\n\n    return false;\n  }\n\n  /**\n   * Validates this package\n   * @param {PackageMetadata[]} manifest Global manifest\n   * @return {boolean}\n   */\n  validate(manifest) {\n    return this.script &&\n      this.metadata &&\n      !!manifest.find(iter => iter.name === this.metadata.name);\n  }\n\n  /**\n   * Initializes this package\n   * @return {Promise<undefined>}\n   */\n  init() {\n    const mod = require(this.script);\n    const handler = typeof mod.default === 'function' ? mod.default : mod;\n\n    this.handler = handler(this.core, this);\n\n    if (typeof this.handler.init === 'function') {\n      return this.handler.init();\n    }\n\n    return Promise.resolve();\n  }\n\n  /**\n   * Starts server scripts\n   * @return {Promise<undefined>}\n   */\n  start() {\n    return this.action('start');\n  }\n\n  /**\n   * Creates a watch in package dist\n   * @param {Function} cb Callback function on watch changes\n   * @return {string} Watched path\n   */\n  watch(cb) {\n    const pub = this.core.config('public');\n    const dist = path.join(pub, 'apps', this.metadata.name);\n\n    this.watcher = chokidar.watch(dist);\n    this.watcher.on('change', () => cb(this.metadata));\n\n    return dist;\n  }\n\n  /**\n   * Resolve an URL for resource\n   * @param {string} path Input path\n   * @return {string}\n   */\n  resource(path) {\n    if (path.substr(0, 1) !== '/') {\n      path = '/' + path;\n    }\n\n    return `/apps/${this.metadata.name}${path}`;\n  }\n}\n\nmodule.exports = Package;\n",
    "static": true,
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/src/package.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 140,
    "kind": "typedef",
    "name": "PackageMetadata",
    "memberof": "src/package.js",
    "static": true,
    "longname": "src/package.js~PackageMetadata",
    "access": "public",
    "description": "TODO: typedef",
    "type": {
      "types": [
        "Object"
      ],
      "optional": false,
      "name": "PackageMetadata"
    }
  },
  {
    "__docId__": 141,
    "kind": "typedef",
    "name": "PackageOptions",
    "memberof": "src/package.js",
    "static": true,
    "longname": "src/package.js~PackageOptions",
    "access": "public",
    "description": "Package Options",
    "properties": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "filename",
        "description": ""
      },
      {
        "nullable": null,
        "types": [
          "PackageMetadata"
        ],
        "spread": false,
        "optional": false,
        "name": "metadata",
        "description": ""
      }
    ],
    "type": {
      "types": [
        "Object"
      ],
      "optional": false,
      "name": "PackageOptions"
    }
  },
  {
    "__docId__": 142,
    "kind": "class",
    "name": "Package",
    "memberof": "src/package.js",
    "static": true,
    "longname": "src/package.js~Package",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/package.js",
    "importStyle": "Package",
    "description": "OS.js Package Abstraction",
    "lineNumber": 49,
    "interface": false
  },
  {
    "__docId__": 143,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "src/package.js~Package",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/package.js~Package#constructor",
    "access": "public",
    "description": "Create new instance",
    "lineNumber": 56,
    "params": [
      {
        "nullable": null,
        "types": [
          "Core"
        ],
        "spread": false,
        "optional": false,
        "name": "core",
        "description": "Core reference"
      },
      {
        "nullable": null,
        "types": [
          "PackageOptions"
        ],
        "spread": false,
        "optional": true,
        "name": "options",
        "description": "Instance options"
      }
    ]
  },
  {
    "__docId__": 144,
    "kind": "member",
    "name": "core",
    "memberof": "src/package.js~Package",
    "static": false,
    "longname": "src/package.js~Package#core",
    "access": "public",
    "description": "",
    "lineNumber": 60,
    "type": {
      "nullable": null,
      "types": [
        "Core"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 145,
    "kind": "member",
    "name": "script",
    "memberof": "src/package.js~Package",
    "static": false,
    "longname": "src/package.js~Package#script",
    "access": "public",
    "description": null,
    "lineNumber": 62,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 146,
    "kind": "member",
    "name": "filename",
    "memberof": "src/package.js~Package",
    "static": false,
    "longname": "src/package.js~Package#filename",
    "access": "public",
    "description": "",
    "lineNumber": 69,
    "type": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 147,
    "kind": "member",
    "name": "metadata",
    "memberof": "src/package.js~Package",
    "static": false,
    "longname": "src/package.js~Package#metadata",
    "access": "public",
    "description": "",
    "lineNumber": 74,
    "type": {
      "nullable": null,
      "types": [
        "PackageMetadata"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 148,
    "kind": "member",
    "name": "handler",
    "memberof": "src/package.js~Package",
    "static": false,
    "longname": "src/package.js~Package#handler",
    "access": "public",
    "description": null,
    "lineNumber": 76,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 149,
    "kind": "member",
    "name": "watcher",
    "memberof": "src/package.js~Package",
    "static": false,
    "longname": "src/package.js~Package#watcher",
    "access": "public",
    "description": null,
    "lineNumber": 78,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 150,
    "kind": "method",
    "name": "destroy",
    "memberof": "src/package.js~Package",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/package.js~Package#destroy",
    "access": "public",
    "description": "Destroys instance",
    "lineNumber": 84,
    "params": [],
    "return": null
  },
  {
    "__docId__": 152,
    "kind": "method",
    "name": "action",
    "memberof": "src/package.js~Package",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/package.js~Package#action",
    "access": "public",
    "description": "Run method on package script",
    "lineNumber": 99,
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "method",
        "description": "Method name"
      },
      {
        "nullable": null,
        "types": [
          "*"
        ],
        "spread": false,
        "optional": true,
        "name": "...args",
        "description": "Pass arguments"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 153,
    "kind": "method",
    "name": "validate",
    "memberof": "src/package.js~Package",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/package.js~Package#validate",
    "access": "public",
    "description": "Validates this package",
    "lineNumber": 118,
    "params": [
      {
        "nullable": null,
        "types": [
          "PackageMetadata[]"
        ],
        "spread": false,
        "optional": false,
        "name": "manifest",
        "description": "Global manifest"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 154,
    "kind": "method",
    "name": "init",
    "memberof": "src/package.js~Package",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/package.js~Package#init",
    "access": "public",
    "description": "Initializes this package",
    "lineNumber": 128,
    "return": {
      "nullable": null,
      "types": [
        "Promise<undefined>"
      ],
      "spread": false,
      "description": ""
    },
    "params": []
  },
  {
    "__docId__": 156,
    "kind": "method",
    "name": "start",
    "memberof": "src/package.js~Package",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/package.js~Package#start",
    "access": "public",
    "description": "Starts server scripts",
    "lineNumber": 145,
    "return": {
      "nullable": null,
      "types": [
        "Promise<undefined>"
      ],
      "spread": false,
      "description": ""
    },
    "params": []
  },
  {
    "__docId__": 157,
    "kind": "method",
    "name": "watch",
    "memberof": "src/package.js~Package",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/package.js~Package#watch",
    "access": "public",
    "description": "Creates a watch in package dist",
    "lineNumber": 154,
    "params": [
      {
        "nullable": null,
        "types": [
          "Function"
        ],
        "spread": false,
        "optional": false,
        "name": "cb",
        "description": "Callback function on watch changes"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "Watched path"
    }
  },
  {
    "__docId__": 159,
    "kind": "method",
    "name": "resource",
    "memberof": "src/package.js~Package",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/package.js~Package#resource",
    "access": "public",
    "description": "Resolve an URL for resource",
    "lineNumber": 169,
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "path",
        "description": "Input path"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 160,
    "kind": "file",
    "name": "src/packages.js",
    "content": "/*\n * OS.js - JavaScript Cloud/Web Desktop Platform\n *\n * Copyright (c) Anders Evenrud <andersevenrud@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * @author  Anders Evenrud <andersevenrud@gmail.com>\n * @licence Simplified BSD License\n */\n\nconst fs = require('fs-extra');\nconst fg = require('fast-glob');\nconst path = require('path');\nconst Package = require('./package.js');\nconst consola = require('consola');\nconst logger = consola.withTag('Packages');\n\nconst relative = filename => filename.replace(process.cwd(), '');\n\nconst readOrDefault = filename => fs.existsSync(filename)\n  ? fs.readJsonSync(filename)\n  : [];\n\n/**\n * Package Service Options\n * @typedef {Object} PackagesOptions\n * @property {string} [manifestFile] Manifest filename\n * @property {string} [discoveredFile] Discovery output file\n */\n\n/**\n * OS.js Package Management\n */\nclass Packages {\n\n  /**\n   * Create new instance\n   * @param {Core} core Core reference\n   * @param {PackagesOptions} [options] Instance options\n   */\n  constructor(core, options = {}) {\n    /**\n     * @type {Core}\n     */\n    this.core = core;\n\n    /**\n     * @type {Package[]}\n     */\n    this.packages = [];\n\n    this.hotReloading = {};\n\n    /**\n     * @type {PackagesOptions}\n     */\n    this.options = {\n      manifestFile: null,\n      discoveredFile: null,\n      ...options\n    };\n  }\n\n  /**\n   * Initializes packages\n   */\n  init() {\n    this.core.on('osjs/application:socket:message', (ws, ...params) => {\n      this.handleMessage(ws, params);\n    });\n\n    return this.load();\n  }\n\n  /**\n   * Loads package manager\n   * @return {Promise<boolean>}\n   */\n  load() {\n    return this.createLoader()\n      .then(packages => {\n        this.packages = this.packages.concat(packages);\n\n        return true;\n      });\n  }\n\n  /**\n   * Loads all packages\n   * @return {Promise<Package[]>}\n   */\n  createLoader() {\n    let result = [];\n    const {discoveredFile, manifestFile} = this.options;\n    const discovered = readOrDefault(discoveredFile);\n    const manifest = readOrDefault(manifestFile);\n    const sources = discovered.map(d => path.join(d, 'metadata.json'));\n\n    logger.info('Using package discovery file', relative(discoveredFile));\n    logger.info('Using package manifest file', relative(manifestFile));\n\n    const stream = fg.stream(sources, {\n      extension: false,\n      brace: false,\n      deep: 1,\n      case: false\n    });\n\n    stream.on('error', error => logger.error(error));\n    stream.on('data', filename => {\n      result.push(this.loadPackage(filename, manifest));\n    });\n\n    return new Promise((resolve, reject) => {\n      stream.once('end', () => {\n        Promise.all(result)\n          .then(result => result.filter(iter => !!iter.handler))\n          .then(resolve)\n          .catch(reject);\n      });\n    });\n  }\n\n  /**\n   * When a package dist has changed\n   * @param {Package} pkg Package instance\n   */\n  onPackageChanged(pkg) {\n    clearTimeout(this.hotReloading[pkg.metadata.name]);\n\n    this.hotReloading[pkg.metadata.name] = setTimeout(() => {\n      logger.debug('Sending reload signal for', pkg.metadata.name);\n      this.core.broadcast('osjs/packages:package:changed', [pkg.metadata.name]);\n    }, 500);\n  }\n\n  /**\n   * Loads package data\n   * @param {string} filename Filename\n   * @param {PackageMetadata} manifest Manifest\n   * @return {Promise<Package>}\n   */\n  loadPackage(filename, manifest) {\n    const done = (pkg, error) => {\n      if (error) {\n        logger.warn(error);\n      }\n\n      return Promise.resolve(pkg);\n    };\n\n    return fs.readJson(filename)\n      .then(metadata => {\n        const pkg = new Package(this.core, {\n          filename,\n          metadata\n        });\n\n        return this.initializePackage(pkg, manifest, done);\n      });\n  }\n\n  /**\n   * Initializes a package\n   * @return {Promise<Package>}\n   */\n  initializePackage(pkg, manifest, done) {\n    if (pkg.validate(manifest)) {\n      logger.info(`Loading ${relative(pkg.script)}`);\n\n      try {\n        if (this.core.configuration.development) {\n          pkg.watch(() => {\n            this.onPackageChanged(pkg);\n          });\n        }\n\n        return pkg.init()\n          .then(() => done(pkg))\n          .catch(e => done(pkg, e));\n      } catch (e) {\n        return done(pkg, e);\n      }\n    }\n\n    return done(pkg);\n  }\n\n  /**\n   * Starts packages\n   */\n  start() {\n    this.packages.forEach(pkg => pkg.start());\n  }\n\n  /**\n   * Destroys packages\n   * @return {Promise<undefined>}\n   */\n  async destroy() {\n    await Promise.all(this.packages.map(pkg => pkg.destroy()));\n\n    this.packages = [];\n  }\n\n  /**\n   * Handles an incoming message and signals an application\n   *\n   * This will call the 'onmessage' event in your application server script\n   *\n   * @param {WebSocket} ws Websocket Connection client\n   * @param {Array} params A list of incoming parameters\n   */\n  handleMessage(ws, params) {\n    const {pid, name, args} = params[0];\n    const found = this.packages.findIndex(({metadata}) => metadata.name === name);\n\n    if (found !== -1) {\n      const {handler} = this.packages[found];\n      if (handler && typeof handler.onmessage === 'function') {\n        const respond = (...respondParams) => ws.send(JSON.stringify({\n          name: 'osjs/application:socket:message',\n          params: [{\n            pid,\n            args: respondParams\n          }]\n        }));\n\n        handler.onmessage(ws, respond, args);\n      }\n    }\n  }\n}\n\nmodule.exports = Packages;\n",
    "static": true,
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/src/packages.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 161,
    "kind": "variable",
    "name": "logger",
    "memberof": "src/packages.js",
    "static": true,
    "longname": "src/packages.js~logger",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/packages.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 36,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 162,
    "kind": "function",
    "name": "relative",
    "memberof": "src/packages.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/packages.js~relative",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/packages.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 38,
    "undocument": true,
    "params": [
      {
        "name": "filename",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 163,
    "kind": "function",
    "name": "readOrDefault",
    "memberof": "src/packages.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/packages.js~readOrDefault",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/packages.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 40,
    "undocument": true,
    "params": [
      {
        "name": "filename",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 164,
    "kind": "typedef",
    "name": "PackagesOptions",
    "memberof": "src/packages.js",
    "static": true,
    "longname": "src/packages.js~PackagesOptions",
    "access": "public",
    "description": "Package Service Options",
    "properties": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": true,
        "name": "manifestFile",
        "description": "Manifest filename"
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": true,
        "name": "discoveredFile",
        "description": "Discovery output file"
      }
    ],
    "type": {
      "types": [
        "Object"
      ],
      "optional": false,
      "name": "PackagesOptions"
    }
  },
  {
    "__docId__": 165,
    "kind": "class",
    "name": "Packages",
    "memberof": "src/packages.js",
    "static": true,
    "longname": "src/packages.js~Packages",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/packages.js",
    "importStyle": "Packages",
    "description": "OS.js Package Management",
    "lineNumber": 54,
    "interface": false
  },
  {
    "__docId__": 166,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "src/packages.js~Packages",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/packages.js~Packages#constructor",
    "access": "public",
    "description": "Create new instance",
    "lineNumber": 61,
    "params": [
      {
        "nullable": null,
        "types": [
          "Core"
        ],
        "spread": false,
        "optional": false,
        "name": "core",
        "description": "Core reference"
      },
      {
        "nullable": null,
        "types": [
          "PackagesOptions"
        ],
        "spread": false,
        "optional": true,
        "name": "options",
        "description": "Instance options"
      }
    ]
  },
  {
    "__docId__": 167,
    "kind": "member",
    "name": "core",
    "memberof": "src/packages.js~Packages",
    "static": false,
    "longname": "src/packages.js~Packages#core",
    "access": "public",
    "description": "",
    "lineNumber": 65,
    "type": {
      "nullable": null,
      "types": [
        "Core"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 168,
    "kind": "member",
    "name": "packages",
    "memberof": "src/packages.js~Packages",
    "static": false,
    "longname": "src/packages.js~Packages#packages",
    "access": "public",
    "description": "",
    "lineNumber": 70,
    "type": {
      "nullable": null,
      "types": [
        "Package[]"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 169,
    "kind": "member",
    "name": "hotReloading",
    "memberof": "src/packages.js~Packages",
    "static": false,
    "longname": "src/packages.js~Packages#hotReloading",
    "access": "public",
    "description": null,
    "lineNumber": 72,
    "undocument": true,
    "type": {
      "types": [
        "{}"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 170,
    "kind": "member",
    "name": "options",
    "memberof": "src/packages.js~Packages",
    "static": false,
    "longname": "src/packages.js~Packages#options",
    "access": "public",
    "description": "",
    "lineNumber": 77,
    "type": {
      "nullable": null,
      "types": [
        "PackagesOptions"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 171,
    "kind": "method",
    "name": "init",
    "memberof": "src/packages.js~Packages",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/packages.js~Packages#init",
    "access": "public",
    "description": "Initializes packages",
    "lineNumber": 87,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 172,
    "kind": "method",
    "name": "load",
    "memberof": "src/packages.js~Packages",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/packages.js~Packages#load",
    "access": "public",
    "description": "Loads package manager",
    "lineNumber": 99,
    "return": {
      "nullable": null,
      "types": [
        "Promise<boolean>"
      ],
      "spread": false,
      "description": ""
    },
    "params": []
  },
  {
    "__docId__": 174,
    "kind": "method",
    "name": "createLoader",
    "memberof": "src/packages.js~Packages",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/packages.js~Packages#createLoader",
    "access": "public",
    "description": "Loads all packages",
    "lineNumber": 112,
    "return": {
      "nullable": null,
      "types": [
        "Promise<Package[]>"
      ],
      "spread": false,
      "description": ""
    },
    "params": []
  },
  {
    "__docId__": 175,
    "kind": "method",
    "name": "onPackageChanged",
    "memberof": "src/packages.js~Packages",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/packages.js~Packages#onPackageChanged",
    "access": "public",
    "description": "When a package dist has changed",
    "lineNumber": 148,
    "params": [
      {
        "nullable": null,
        "types": [
          "Package"
        ],
        "spread": false,
        "optional": false,
        "name": "pkg",
        "description": "Package instance"
      }
    ],
    "return": null
  },
  {
    "__docId__": 176,
    "kind": "method",
    "name": "loadPackage",
    "memberof": "src/packages.js~Packages",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/packages.js~Packages#loadPackage",
    "access": "public",
    "description": "Loads package data",
    "lineNumber": 163,
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "filename",
        "description": "Filename"
      },
      {
        "nullable": null,
        "types": [
          "PackageMetadata"
        ],
        "spread": false,
        "optional": false,
        "name": "manifest",
        "description": "Manifest"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise<Package>"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 177,
    "kind": "method",
    "name": "initializePackage",
    "memberof": "src/packages.js~Packages",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/packages.js~Packages#initializePackage",
    "access": "public",
    "description": "Initializes a package",
    "lineNumber": 187,
    "return": {
      "nullable": null,
      "types": [
        "Promise<Package>"
      ],
      "spread": false,
      "description": ""
    },
    "params": [
      {
        "name": "pkg",
        "types": [
          "*"
        ]
      },
      {
        "name": "manifest",
        "types": [
          "*"
        ]
      },
      {
        "name": "done",
        "types": [
          "*"
        ]
      }
    ]
  },
  {
    "__docId__": 178,
    "kind": "method",
    "name": "start",
    "memberof": "src/packages.js~Packages",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/packages.js~Packages#start",
    "access": "public",
    "description": "Starts packages",
    "lineNumber": 212,
    "params": [],
    "return": null
  },
  {
    "__docId__": 179,
    "kind": "method",
    "name": "destroy",
    "memberof": "src/packages.js~Packages",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/packages.js~Packages#destroy",
    "access": "public",
    "description": "Destroys packages",
    "lineNumber": 220,
    "return": {
      "nullable": null,
      "types": [
        "Promise<undefined>"
      ],
      "spread": false,
      "description": ""
    },
    "params": []
  },
  {
    "__docId__": 181,
    "kind": "method",
    "name": "handleMessage",
    "memberof": "src/packages.js~Packages",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/packages.js~Packages#handleMessage",
    "access": "public",
    "description": "Handles an incoming message and signals an application\n\nThis will call the 'onmessage' event in your application server script",
    "lineNumber": 234,
    "params": [
      {
        "nullable": null,
        "types": [
          "WebSocket"
        ],
        "spread": false,
        "optional": false,
        "name": "ws",
        "description": "Websocket Connection client"
      },
      {
        "nullable": null,
        "types": [
          "Array"
        ],
        "spread": false,
        "optional": false,
        "name": "params",
        "description": "A list of incoming parameters"
      }
    ],
    "return": null
  },
  {
    "__docId__": 182,
    "kind": "file",
    "name": "src/providers/auth.js",
    "content": "/*\n * OS.js - JavaScript Cloud/Web Desktop Platform\n *\n * Copyright (c) Anders Evenrud <andersevenrud@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * @author  Anders Evenrud <andersevenrud@gmail.com>\n * @licence Simplified BSD License\n */\n\nconst {ServiceProvider} = require('@osjs/common');\nconst Auth = require('../auth.js');\n\n/**\n * OS.js Auth Service Provider\n */\nclass AuthServiceProvider extends ServiceProvider {\n\n  constructor(core, options) {\n    super(core, options);\n\n    this.auth = new Auth(core, options);\n  }\n\n  destroy() {\n    this.auth.destroy();\n\n    super.destroy();\n  }\n\n  async init() {\n    const {route, routeAuthenticated} = this.core.make('osjs/express');\n\n    route('post', '/register', (req, res) => this.auth.register(req, res));\n    route('post', '/login', (req, res) => this.auth.login(req, res));\n    routeAuthenticated('post', '/logout', (req, res) => this.auth.logout(req, res));\n\n    await this.auth.init();\n  }\n}\n\nmodule.exports = AuthServiceProvider;\n",
    "static": true,
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/src/providers/auth.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 183,
    "kind": "variable",
    "name": "ServiceProvider",
    "memberof": "src/providers/auth.js",
    "static": true,
    "longname": "src/providers/auth.js~ServiceProvider",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/providers/auth.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 32,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 184,
    "kind": "class",
    "name": "AuthServiceProvider",
    "memberof": "src/providers/auth.js",
    "static": true,
    "longname": "src/providers/auth.js~AuthServiceProvider",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/providers/auth.js",
    "importStyle": "AuthServiceProvider",
    "description": "OS.js Auth Service Provider",
    "lineNumber": 38,
    "interface": false,
    "extends": [
      "ServiceProvider"
    ]
  },
  {
    "__docId__": 185,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "src/providers/auth.js~AuthServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/auth.js~AuthServiceProvider#constructor",
    "access": "public",
    "description": null,
    "lineNumber": 40,
    "undocument": true,
    "ignore": true
  },
  {
    "__docId__": 186,
    "kind": "member",
    "name": "auth",
    "memberof": "src/providers/auth.js~AuthServiceProvider",
    "static": false,
    "longname": "src/providers/auth.js~AuthServiceProvider#auth",
    "access": "public",
    "description": null,
    "lineNumber": 43,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 187,
    "kind": "method",
    "name": "destroy",
    "memberof": "src/providers/auth.js~AuthServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/auth.js~AuthServiceProvider#destroy",
    "access": "public",
    "description": null,
    "lineNumber": 46,
    "undocument": true,
    "params": [],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 188,
    "kind": "method",
    "name": "init",
    "memberof": "src/providers/auth.js~AuthServiceProvider",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/providers/auth.js~AuthServiceProvider#init",
    "access": "public",
    "description": null,
    "lineNumber": 52,
    "undocument": true,
    "params": [],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 189,
    "kind": "file",
    "name": "src/providers/core.js",
    "content": "/**\n * OS.js - JavaScript Cloud/Web Desktop Platform\n *\n * Copyright (c) Anders Evenrud <andersevenrud@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * @author  Anders Evenrud <andersevenrud@gmail.com>\n * @licence Simplified BSD License\n */\n\nconst path = require('path');\nconst express = require('express');\nconst chokidar = require('chokidar');\nconst bodyParser = require('body-parser');\nconst proxy = require('express-http-proxy');\nconst nocache = require('nocache');\nconst {ServiceProvider} = require('@osjs/common');\nconst {isAuthenticated, closeWatches} = require('../utils/core.js');\n\n/**\n * OS.js Core Service Provider\n */\nclass CoreServiceProvider extends ServiceProvider {\n\n  constructor(core, options) {\n    super(core, options);\n\n    this.watches = [];\n  }\n\n  async destroy() {\n    await closeWatches(this.watches);\n    super.destroy();\n  }\n\n  async init() {\n    this.initService();\n    this.initExtensions();\n    this.initResourceRoutes();\n    this.initSocketRoutes();\n    this.initProxies();\n  }\n\n  start() {\n    if (this.core.configuration.development) {\n      this.initDeveloperTools();\n    }\n  }\n\n  provides() {\n    return [\n      'osjs/express'\n    ];\n  }\n\n  /**\n   * Initializes the service APIs\n   */\n  initService() {\n    const {app} = this.core;\n    const {requireAllGroups} = this.core.configuration.auth;\n\n    const middleware = {\n      route: [],\n      routeAuthenticated: []\n    };\n\n    this.core.singleton('osjs/express', () => ({\n      isAuthenticated,\n\n      call: (method, ...args) => app[method](...args),\n      use: (arg) => app.use(arg),\n\n      websocket: (p, cb) => app.ws(p, cb),\n\n      middleware: (authentication, cb) => {\n        middleware[authentication ? 'routeAuthenticated' : 'route'].push(cb);\n      },\n\n      route: (method, uri, cb) => app[method.toLowerCase()](uri, [\n        ...middleware.route\n      ], cb),\n\n      routeAuthenticated: (method, uri, cb, groups = [], strict = requireAllGroups) =>\n        app[method.toLowerCase()](uri, [\n          ...middleware.routeAuthenticated,\n          isAuthenticated(groups, strict)\n        ], cb),\n\n      router: () => {\n        const router = express.Router();\n        router.use(...middleware.route);\n        return router;\n      },\n\n      routerAuthenticated: (groups = [], strict = requireAllGroups) => {\n        const router = express.Router();\n        router.use(...middleware.routeAuthenticated);\n        router.use(isAuthenticated(groups, strict));\n        return router;\n      }\n    }));\n  }\n\n  /**\n   * Initializes Express extensions\n   */\n  initExtensions() {\n    const {app, session, configuration} = this.core;\n    const limit = configuration.express.maxBodySize;\n\n    if (configuration.development) {\n      app.use(nocache());\n    } else {\n      app.disable('x-powered-by');\n    }\n\n    // Handle sessions\n    app.use(session);\n\n    // Handle bodies\n    app.use(bodyParser.urlencoded({\n      extended: false,\n      limit\n    }));\n\n    app.use(bodyParser.json({\n      limit\n    }));\n\n    app.use(bodyParser.raw({\n      limit\n    }));\n  }\n\n  /**\n   * Initializes Express base routes, etc\n   */\n  initResourceRoutes() {\n    const {app, configuration} = this.core;\n    const indexFile = path.join(configuration.public, configuration.index);\n\n    app.get('/', (req, res) => res.sendFile(indexFile));\n    app.use('/', express.static(configuration.public));\n\n    // Internal ping\n    app.get('/ping', (req, res) => {\n      this.core.emit('osjs/core:ping', req);\n\n      try {\n        req.session.touch();\n      } catch (e) {\n        this.core.logger.warn(e);\n      }\n\n      res.status(200).send('ok');\n    });\n  }\n\n  /**\n   * Initializes Socket routes\n   */\n  initSocketRoutes() {\n    const {app} = this.core;\n\n    app.ws('/', (ws, req) => {\n      ws.upgradeReq = ws.upgradeReq || req;\n      ws._osjs_client = {...req.session.user};\n\n      const interval = this.core.config('ws.ping', 0);\n\n      const pingInterval = interval ? setInterval(() => {\n        ws.send(JSON.stringify({\n          name: 'osjs/core:ping'\n        }));\n      }, interval) : undefined;\n\n      ws.on('close', () => {\n        clearInterval(pingInterval);\n      });\n\n      ws.on('message', msg => {\n        try {\n          const {name, params} = JSON.parse(msg);\n\n          if (typeof name === 'string' && params instanceof Array) {\n            // We don't wanna allow any internal signals from the outside!\n            if (name.match(/^osjs/) && name !== 'osjs/application:socket:message') {\n              return;\n            }\n\n            this.core.emit(name, ws, ...params);\n          }\n        } catch (e) {\n          this.core.logger.warn(e);\n        }\n      });\n\n      ws.send(JSON.stringify({\n        name: 'osjs/core:connected',\n        params: [{\n          cookie: {\n            maxAge: this.core.config('session.options.cookie.maxAge')\n          }\n        }]\n      }));\n    });\n  }\n\n  /**\n   * Initializes Express proxies\n   */\n  initProxies() {\n    const {app, configuration} = this.core;\n    const proxies = (configuration.proxy || []).map(item => ({\n      source: null,\n      destination: null,\n      options: {},\n      ...item\n    })).filter(item => item.source && item.destination);\n\n    proxies.forEach(item => {\n      this.core.logger.info(`Proxying ${item.source} -> ${item.destination}`);\n      app.use(item.source, proxy(item.destination, item.options));\n    });\n  }\n\n  /**\n   * Initializes some developer features\n   */\n  initDeveloperTools() {\n    try {\n      const watchdir = path.resolve(this.core.configuration.public);\n      const watcher = chokidar.watch(watchdir);\n\n      watcher.on('change', filename => {\n        // NOTE: 'ignored' does not work as expected with callback\n        // ignored: str => str.match(/\\.(js|css)$/) === null\n        // for unknown reasons\n        if (!filename.match(/\\.(js|css)$/)) {\n          return;\n        }\n\n        const relative = filename.replace(watchdir, '');\n        this.core.broadcast('osjs/dist:changed', [relative]);\n      });\n\n      this.watches.push(watcher);\n    } catch (e) {\n      this.core.logger.warn(e);\n    }\n  }\n}\n\nmodule.exports = CoreServiceProvider;\n",
    "static": true,
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/src/providers/core.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 190,
    "kind": "variable",
    "name": "ServiceProvider",
    "memberof": "src/providers/core.js",
    "static": true,
    "longname": "src/providers/core.js~ServiceProvider",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/providers/core.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 38,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 191,
    "kind": "variable",
    "name": "isAuthenticated",
    "memberof": "src/providers/core.js",
    "static": true,
    "longname": "src/providers/core.js~isAuthenticated",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/providers/core.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 40,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 192,
    "kind": "class",
    "name": "CoreServiceProvider",
    "memberof": "src/providers/core.js",
    "static": true,
    "longname": "src/providers/core.js~CoreServiceProvider",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/providers/core.js",
    "importStyle": "CoreServiceProvider",
    "description": "OS.js Core Service Provider",
    "lineNumber": 45,
    "interface": false,
    "extends": [
      "ServiceProvider"
    ]
  },
  {
    "__docId__": 193,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "src/providers/core.js~CoreServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/core.js~CoreServiceProvider#constructor",
    "access": "public",
    "description": null,
    "lineNumber": 47,
    "undocument": true,
    "ignore": true
  },
  {
    "__docId__": 194,
    "kind": "member",
    "name": "watches",
    "memberof": "src/providers/core.js~CoreServiceProvider",
    "static": false,
    "longname": "src/providers/core.js~CoreServiceProvider#watches",
    "access": "public",
    "description": null,
    "lineNumber": 50,
    "undocument": true,
    "type": {
      "types": [
        "*[]"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 195,
    "kind": "method",
    "name": "destroy",
    "memberof": "src/providers/core.js~CoreServiceProvider",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/providers/core.js~CoreServiceProvider#destroy",
    "access": "public",
    "description": null,
    "lineNumber": 53,
    "undocument": true,
    "params": [],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 196,
    "kind": "method",
    "name": "init",
    "memberof": "src/providers/core.js~CoreServiceProvider",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/providers/core.js~CoreServiceProvider#init",
    "access": "public",
    "description": null,
    "lineNumber": 58,
    "undocument": true,
    "params": [],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 197,
    "kind": "method",
    "name": "start",
    "memberof": "src/providers/core.js~CoreServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/core.js~CoreServiceProvider#start",
    "access": "public",
    "description": null,
    "lineNumber": 66,
    "undocument": true,
    "params": [],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 198,
    "kind": "method",
    "name": "provides",
    "memberof": "src/providers/core.js~CoreServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/core.js~CoreServiceProvider#provides",
    "access": "public",
    "description": null,
    "lineNumber": 72,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "string[]"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 199,
    "kind": "method",
    "name": "initService",
    "memberof": "src/providers/core.js~CoreServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/core.js~CoreServiceProvider#initService",
    "access": "public",
    "description": "Initializes the service APIs",
    "lineNumber": 81,
    "params": [],
    "return": null
  },
  {
    "__docId__": 200,
    "kind": "method",
    "name": "initExtensions",
    "memberof": "src/providers/core.js~CoreServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/core.js~CoreServiceProvider#initExtensions",
    "access": "public",
    "description": "Initializes Express extensions",
    "lineNumber": 130,
    "params": [],
    "return": null
  },
  {
    "__docId__": 201,
    "kind": "method",
    "name": "initResourceRoutes",
    "memberof": "src/providers/core.js~CoreServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/core.js~CoreServiceProvider#initResourceRoutes",
    "access": "public",
    "description": "Initializes Express base routes, etc",
    "lineNumber": 161,
    "params": [],
    "return": null
  },
  {
    "__docId__": 202,
    "kind": "method",
    "name": "initSocketRoutes",
    "memberof": "src/providers/core.js~CoreServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/core.js~CoreServiceProvider#initSocketRoutes",
    "access": "public",
    "description": "Initializes Socket routes",
    "lineNumber": 185,
    "params": [],
    "return": null
  },
  {
    "__docId__": 203,
    "kind": "method",
    "name": "initProxies",
    "memberof": "src/providers/core.js~CoreServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/core.js~CoreServiceProvider#initProxies",
    "access": "public",
    "description": "Initializes Express proxies",
    "lineNumber": 235,
    "params": [],
    "return": null
  },
  {
    "__docId__": 204,
    "kind": "method",
    "name": "initDeveloperTools",
    "memberof": "src/providers/core.js~CoreServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/core.js~CoreServiceProvider#initDeveloperTools",
    "access": "public",
    "description": "Initializes some developer features",
    "lineNumber": 253,
    "params": [],
    "return": null
  },
  {
    "__docId__": 205,
    "kind": "file",
    "name": "src/providers/packages.js",
    "content": "/**\n * OS.js - JavaScript Cloud/Web Desktop Platform\n *\n * Copyright (c) Anders Evenrud <andersevenrud@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * @author  Anders Evenrud <andersevenrud@gmail.com>\n * @licence Simplified BSD License\n */\n\nconst fs = require('fs-extra');\nconst path = require('path');\nconst chokidar = require('chokidar');\nconst {ServiceProvider} = require('@osjs/common');\nconst Packages = require('../packages');\nconst {closeWatches} = require('../utils/core');\n\n/**\n * OS.js Package Service Provider\n */\nclass PackageServiceProvider extends ServiceProvider {\n  constructor(core) {\n    super(core);\n\n    const {configuration} = this.core;\n    const manifestFile = path.join(configuration.public, configuration.packages.metadata);\n    const discoveredFile = path.resolve(configuration.root, configuration.packages.discovery);\n\n    this.watches = [];\n    this.packages = new Packages(core, {\n      manifestFile,\n      discoveredFile\n    });\n  }\n\n  provides() {\n    return [\n      'osjs/packages'\n    ];\n  }\n\n  init() {\n    this.core.singleton('osjs/packages', () => this.packages);\n\n    return this.packages.init();\n  }\n\n  start() {\n    this.packages.start();\n\n    if (this.core.configuration.development) {\n      this.initDeveloperTools();\n    }\n  }\n\n  async destroy() {\n    await closeWatches(this.watches);\n    await this.packages.destroy();\n    super.destroy();\n  }\n\n  /**\n   * Initializes some developer features\n   */\n  initDeveloperTools() {\n    const {manifestFile} = this.packages.options;\n\n    if (fs.existsSync(manifestFile)) {\n      const watcher = chokidar.watch(manifestFile);\n      watcher.on('change', () => {\n        this.core.broadcast('osjs/packages:metadata:changed');\n      });\n      this.watches.push(watcher);\n    }\n  }\n}\n\nmodule.exports = PackageServiceProvider;\n",
    "static": true,
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/src/providers/packages.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 206,
    "kind": "variable",
    "name": "ServiceProvider",
    "memberof": "src/providers/packages.js",
    "static": true,
    "longname": "src/providers/packages.js~ServiceProvider",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/providers/packages.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 35,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 207,
    "kind": "variable",
    "name": "closeWatches",
    "memberof": "src/providers/packages.js",
    "static": true,
    "longname": "src/providers/packages.js~closeWatches",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/providers/packages.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 38,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 208,
    "kind": "class",
    "name": "PackageServiceProvider",
    "memberof": "src/providers/packages.js",
    "static": true,
    "longname": "src/providers/packages.js~PackageServiceProvider",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/providers/packages.js",
    "importStyle": "PackageServiceProvider",
    "description": "OS.js Package Service Provider",
    "lineNumber": 43,
    "interface": false,
    "extends": [
      "ServiceProvider"
    ]
  },
  {
    "__docId__": 209,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "src/providers/packages.js~PackageServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/packages.js~PackageServiceProvider#constructor",
    "access": "public",
    "description": null,
    "lineNumber": 44,
    "undocument": true,
    "ignore": true
  },
  {
    "__docId__": 210,
    "kind": "member",
    "name": "watches",
    "memberof": "src/providers/packages.js~PackageServiceProvider",
    "static": false,
    "longname": "src/providers/packages.js~PackageServiceProvider#watches",
    "access": "public",
    "description": null,
    "lineNumber": 51,
    "undocument": true,
    "type": {
      "types": [
        "*[]"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 211,
    "kind": "member",
    "name": "packages",
    "memberof": "src/providers/packages.js~PackageServiceProvider",
    "static": false,
    "longname": "src/providers/packages.js~PackageServiceProvider#packages",
    "access": "public",
    "description": null,
    "lineNumber": 52,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 212,
    "kind": "method",
    "name": "provides",
    "memberof": "src/providers/packages.js~PackageServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/packages.js~PackageServiceProvider#provides",
    "access": "public",
    "description": null,
    "lineNumber": 58,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "string[]"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 213,
    "kind": "method",
    "name": "init",
    "memberof": "src/providers/packages.js~PackageServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/packages.js~PackageServiceProvider#init",
    "access": "public",
    "description": null,
    "lineNumber": 64,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 214,
    "kind": "method",
    "name": "start",
    "memberof": "src/providers/packages.js~PackageServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/packages.js~PackageServiceProvider#start",
    "access": "public",
    "description": null,
    "lineNumber": 70,
    "undocument": true,
    "params": [],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 215,
    "kind": "method",
    "name": "destroy",
    "memberof": "src/providers/packages.js~PackageServiceProvider",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/providers/packages.js~PackageServiceProvider#destroy",
    "access": "public",
    "description": null,
    "lineNumber": 78,
    "undocument": true,
    "params": [],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 216,
    "kind": "method",
    "name": "initDeveloperTools",
    "memberof": "src/providers/packages.js~PackageServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/packages.js~PackageServiceProvider#initDeveloperTools",
    "access": "public",
    "description": "Initializes some developer features",
    "lineNumber": 87,
    "params": [],
    "return": null
  },
  {
    "__docId__": 217,
    "kind": "file",
    "name": "src/providers/settings.js",
    "content": "/**\n * OS.js - JavaScript Cloud/Web Desktop Platform\n *\n * Copyright (c) Anders Evenrud <andersevenrud@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * @author  Anders Evenrud <andersevenrud@gmail.com>\n * @licence Simplified BSD License\n */\n\nconst Settings = require('../settings');\nconst {ServiceProvider} = require('@osjs/common');\n\n/**\n * OS.js Settings Service Provider\n */\nclass SettingsServiceProvider extends ServiceProvider {\n\n  constructor(core, options) {\n    super(core, options);\n\n    this.settings = new Settings(core, options);\n  }\n\n  destroy() {\n    super.destroy();\n    this.settings.destroy();\n  }\n\n  async init() {\n    this.core.make('osjs/express')\n      .routeAuthenticated('post', '/settings', (req, res) => this.settings.save(req, res));\n\n    this.core.make('osjs/express')\n      .routeAuthenticated('get', '/settings', (req, res) => this.settings.load(req, res));\n\n    return this.settings.init();\n  }\n}\n\nmodule.exports = SettingsServiceProvider;\n",
    "static": true,
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/src/providers/settings.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 218,
    "kind": "variable",
    "name": "ServiceProvider",
    "memberof": "src/providers/settings.js",
    "static": true,
    "longname": "src/providers/settings.js~ServiceProvider",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/providers/settings.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 33,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 219,
    "kind": "class",
    "name": "SettingsServiceProvider",
    "memberof": "src/providers/settings.js",
    "static": true,
    "longname": "src/providers/settings.js~SettingsServiceProvider",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/providers/settings.js",
    "importStyle": "SettingsServiceProvider",
    "description": "OS.js Settings Service Provider",
    "lineNumber": 38,
    "interface": false,
    "extends": [
      "ServiceProvider"
    ]
  },
  {
    "__docId__": 220,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "src/providers/settings.js~SettingsServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/settings.js~SettingsServiceProvider#constructor",
    "access": "public",
    "description": null,
    "lineNumber": 40,
    "undocument": true,
    "ignore": true
  },
  {
    "__docId__": 221,
    "kind": "member",
    "name": "settings",
    "memberof": "src/providers/settings.js~SettingsServiceProvider",
    "static": false,
    "longname": "src/providers/settings.js~SettingsServiceProvider#settings",
    "access": "public",
    "description": null,
    "lineNumber": 43,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 222,
    "kind": "method",
    "name": "destroy",
    "memberof": "src/providers/settings.js~SettingsServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/settings.js~SettingsServiceProvider#destroy",
    "access": "public",
    "description": null,
    "lineNumber": 46,
    "undocument": true,
    "params": [],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 223,
    "kind": "method",
    "name": "init",
    "memberof": "src/providers/settings.js~SettingsServiceProvider",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/providers/settings.js~SettingsServiceProvider#init",
    "access": "public",
    "description": null,
    "lineNumber": 51,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 224,
    "kind": "file",
    "name": "src/providers/vfs.js",
    "content": "/**\n * OS.js - JavaScript Cloud/Web Desktop Platform\n *\n * Copyright (c) Anders Evenrud <andersevenrud@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * @author  Anders Evenrud <andersevenrud@gmail.com>\n * @licence Simplified BSD License\n */\n\nconst {ServiceProvider} = require('@osjs/common');\nconst Filesystem = require('../filesystem');\n\n/**\n * OS.js Virtual Filesystem Service Provider\n */\nclass VFSServiceProvider extends ServiceProvider {\n\n  constructor(core, options = {}) {\n    super(core, options);\n\n    this.filesystem = new Filesystem(core, options);\n  }\n\n  async destroy() {\n    await this.filesystem.destroy();\n    super.destroy();\n  }\n\n  depends() {\n    return [\n      'osjs/express'\n    ];\n  }\n\n  provides() {\n    return [\n      'osjs/fs',\n      'osjs/vfs'\n    ];\n  }\n\n  async init() {\n    const filesystem = this.filesystem;\n\n    await filesystem.init();\n\n    this.core.singleton('osjs/fs', () => this.filesystem);\n\n    this.core.singleton('osjs/vfs', () => ({\n      realpath: (...args) => this.filesystem.realpath(...args),\n      request: (...args) => this.filesystem.request(...args),\n      call: (...args) => this.filesystem.call(...args),\n      mime: (...args) => this.filesystem.mime(...args),\n\n      get adapters() {\n        return filesystem.adapters;\n      },\n\n      get mountpoints() {\n        return filesystem.mountpoints;\n      }\n    }));\n\n    this.core.app.use('/vfs', filesystem.router);\n  }\n}\n\nmodule.exports = VFSServiceProvider;\n",
    "static": true,
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/src/providers/vfs.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 225,
    "kind": "variable",
    "name": "ServiceProvider",
    "memberof": "src/providers/vfs.js",
    "static": true,
    "longname": "src/providers/vfs.js~ServiceProvider",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/providers/vfs.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 32,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 226,
    "kind": "class",
    "name": "VFSServiceProvider",
    "memberof": "src/providers/vfs.js",
    "static": true,
    "longname": "src/providers/vfs.js~VFSServiceProvider",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/providers/vfs.js",
    "importStyle": "VFSServiceProvider",
    "description": "OS.js Virtual Filesystem Service Provider",
    "lineNumber": 38,
    "interface": false,
    "extends": [
      "ServiceProvider"
    ]
  },
  {
    "__docId__": 227,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "src/providers/vfs.js~VFSServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/vfs.js~VFSServiceProvider#constructor",
    "access": "public",
    "description": null,
    "lineNumber": 40,
    "undocument": true,
    "ignore": true
  },
  {
    "__docId__": 228,
    "kind": "member",
    "name": "filesystem",
    "memberof": "src/providers/vfs.js~VFSServiceProvider",
    "static": false,
    "longname": "src/providers/vfs.js~VFSServiceProvider#filesystem",
    "access": "public",
    "description": null,
    "lineNumber": 43,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 229,
    "kind": "method",
    "name": "destroy",
    "memberof": "src/providers/vfs.js~VFSServiceProvider",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/providers/vfs.js~VFSServiceProvider#destroy",
    "access": "public",
    "description": null,
    "lineNumber": 46,
    "undocument": true,
    "params": [],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 230,
    "kind": "method",
    "name": "depends",
    "memberof": "src/providers/vfs.js~VFSServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/vfs.js~VFSServiceProvider#depends",
    "access": "public",
    "description": null,
    "lineNumber": 51,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "string[]"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 231,
    "kind": "method",
    "name": "provides",
    "memberof": "src/providers/vfs.js~VFSServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/providers/vfs.js~VFSServiceProvider#provides",
    "access": "public",
    "description": null,
    "lineNumber": 57,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "string[]"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 232,
    "kind": "method",
    "name": "init",
    "memberof": "src/providers/vfs.js~VFSServiceProvider",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/providers/vfs.js~VFSServiceProvider#init",
    "access": "public",
    "description": null,
    "lineNumber": 64,
    "undocument": true,
    "params": [],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 233,
    "kind": "file",
    "name": "src/settings.js",
    "content": "/*\n * OS.js - JavaScript Cloud/Web Desktop Platform\n *\n * Copyright (c) Anders Evenrud <andersevenrud@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * @author  Anders Evenrud <andersevenrud@gmail.com>\n * @licence Simplified BSD License\n */\n\nconst nullAdapter = require('./adapters/settings/null');\nconst fsAdapter = require('./adapters/settings/fs');\n\n/**\n * TODO: typedef\n * @typedef {Object} SettingsAdapter\n */\n\n/**\n * Settings Service Options\n * @typedef {Object} SettingsOptions\n * @property {SettingsAdapter|string} [adapter]\n */\n\n/**\n * OS.js Settings Manager\n */\nclass Settings {\n\n  /**\n   * Create new instance\n   * @param {Core} core Core reference\n   * @param {SettingsOptions} [options] Instance options\n   */\n  constructor(core, options = {}) {\n    /**\n     * @type {Core}\n     */\n    this.core = core;\n\n    this.options = {\n      adapter: nullAdapter,\n      ...options\n    };\n\n    if (this.options.adapter === 'fs') {\n      this.options.adapter = fsAdapter;\n    }\n\n    this.adapter = nullAdapter(core, this.options.config);\n\n    try {\n      this.adapter = this.options.adapter(core, this.options.config);\n    } catch (e) {\n      this.core.logger.warn(e);\n    }\n  }\n\n  /**\n   * Destroy instance\n   */\n  destroy() {\n    if (this.adapter.destroy) {\n      this.adapter.destroy();\n    }\n  }\n\n  /**\n   * Initializes adapter\n   * @return {Promise<boolean>}\n   */\n  async init() {\n    if (this.adapter.init) {\n      return this.adapter.init();\n    }\n\n    return true;\n  }\n\n  /**\n   * Sends save request to adapter\n   * @param {Request} req Express request\n   * @param {Response} res Express response\n   * @return {Promise<undefined>}\n   */\n  async save(req, res) {\n    const result = await this.adapter.save(req, res);\n    res.json(result);\n  }\n\n  /**\n   * Sends load request to adapter\n   * @param {Request} req Express request\n   * @param {Response} res Express response\n   * @return {Promise<undefined>}\n   */\n  async load(req, res) {\n    const result = await this.adapter.load(req, res);\n    res.json(result);\n  }\n}\n\n\nmodule.exports = Settings;\n",
    "static": true,
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/src/settings.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 234,
    "kind": "typedef",
    "name": "SettingsAdapter",
    "memberof": "src/settings.js",
    "static": true,
    "longname": "src/settings.js~SettingsAdapter",
    "access": "public",
    "description": "TODO: typedef",
    "type": {
      "types": [
        "Object"
      ],
      "optional": false,
      "name": "SettingsAdapter"
    }
  },
  {
    "__docId__": 235,
    "kind": "typedef",
    "name": "SettingsOptions",
    "memberof": "src/settings.js",
    "static": true,
    "longname": "src/settings.js~SettingsOptions",
    "access": "public",
    "description": "Settings Service Options",
    "properties": [
      {
        "nullable": null,
        "types": [
          "SettingsAdapter",
          "string"
        ],
        "spread": false,
        "optional": true,
        "name": "adapter",
        "description": ""
      }
    ],
    "type": {
      "types": [
        "Object"
      ],
      "optional": false,
      "name": "SettingsOptions"
    }
  },
  {
    "__docId__": 236,
    "kind": "class",
    "name": "Settings",
    "memberof": "src/settings.js",
    "static": true,
    "longname": "src/settings.js~Settings",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/settings.js",
    "importStyle": "Settings",
    "description": "OS.js Settings Manager",
    "lineNumber": 48,
    "interface": false
  },
  {
    "__docId__": 237,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "src/settings.js~Settings",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/settings.js~Settings#constructor",
    "access": "public",
    "description": "Create new instance",
    "lineNumber": 55,
    "params": [
      {
        "nullable": null,
        "types": [
          "Core"
        ],
        "spread": false,
        "optional": false,
        "name": "core",
        "description": "Core reference"
      },
      {
        "nullable": null,
        "types": [
          "SettingsOptions"
        ],
        "spread": false,
        "optional": true,
        "name": "options",
        "description": "Instance options"
      }
    ]
  },
  {
    "__docId__": 238,
    "kind": "member",
    "name": "core",
    "memberof": "src/settings.js~Settings",
    "static": false,
    "longname": "src/settings.js~Settings#core",
    "access": "public",
    "description": "",
    "lineNumber": 59,
    "type": {
      "nullable": null,
      "types": [
        "Core"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 239,
    "kind": "member",
    "name": "options",
    "memberof": "src/settings.js~Settings",
    "static": false,
    "longname": "src/settings.js~Settings#options",
    "access": "public",
    "description": null,
    "lineNumber": 61,
    "undocument": true,
    "type": {
      "types": [
        "{\"adapter\": *, ...options: Object}"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 240,
    "kind": "member",
    "name": "adapter",
    "memberof": "src/settings.js~Settings",
    "static": false,
    "longname": "src/settings.js~Settings#adapter",
    "access": "public",
    "description": null,
    "lineNumber": 70,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 242,
    "kind": "method",
    "name": "destroy",
    "memberof": "src/settings.js~Settings",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "src/settings.js~Settings#destroy",
    "access": "public",
    "description": "Destroy instance",
    "lineNumber": 82,
    "params": [],
    "return": null
  },
  {
    "__docId__": 243,
    "kind": "method",
    "name": "init",
    "memberof": "src/settings.js~Settings",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/settings.js~Settings#init",
    "access": "public",
    "description": "Initializes adapter",
    "lineNumber": 92,
    "return": {
      "nullable": null,
      "types": [
        "Promise<boolean>"
      ],
      "spread": false,
      "description": ""
    },
    "params": []
  },
  {
    "__docId__": 244,
    "kind": "method",
    "name": "save",
    "memberof": "src/settings.js~Settings",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/settings.js~Settings#save",
    "access": "public",
    "description": "Sends save request to adapter",
    "lineNumber": 106,
    "params": [
      {
        "nullable": null,
        "types": [
          "Request"
        ],
        "spread": false,
        "optional": false,
        "name": "req",
        "description": "Express request"
      },
      {
        "nullable": null,
        "types": [
          "Response"
        ],
        "spread": false,
        "optional": false,
        "name": "res",
        "description": "Express response"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise<undefined>"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 245,
    "kind": "method",
    "name": "load",
    "memberof": "src/settings.js~Settings",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "src/settings.js~Settings#load",
    "access": "public",
    "description": "Sends load request to adapter",
    "lineNumber": 117,
    "params": [
      {
        "nullable": null,
        "types": [
          "Request"
        ],
        "spread": false,
        "optional": false,
        "name": "req",
        "description": "Express request"
      },
      {
        "nullable": null,
        "types": [
          "Response"
        ],
        "spread": false,
        "optional": false,
        "name": "res",
        "description": "Express response"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise<undefined>"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 246,
    "kind": "file",
    "name": "src/utils/vfs.js",
    "content": "/*\n * OS.js - JavaScript Cloud/Web Desktop Platform\n *\n * Copyright (c) Anders Evenrud <andersevenrud@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * @author  Anders Evenrud <andersevenrud@gmail.com>\n * @licence Simplified BSD License\n */\n\nconst fs = require('fs-extra');\nconst url = require('url');\nconst sanitizeFilename = require('sanitize-filename');\nconst formidable = require('formidable');\nconst {Stream} = require('stream');\n\n/**\n * A map of error codes\n */\nconst errorCodes = {\n  ENOENT: 404,\n  EACCES: 401\n};\n\n/**\n * Gets prefix of a VFS path\n */\nconst getPrefix = path => String(path).split(':')[0];\n\n/**\n * Sanitizes a path\n */\nconst sanitize = filename => {\n  const [name, str] = (filename.replace(/\\/+/g, '/')\n    .match(/^([\\w-_]+):+(.*)/) || [])\n    .slice(1);\n\n  const sane = str.split('/')\n    .map(s => sanitizeFilename(s))\n    .join('/')\n    .replace(/\\/+/g, '/');\n\n  return name + ':' + sane;\n};\n\n/**\n * Gets the stream from a HTTP request\n */\nconst streamFromRequest = req => {\n  const isStream = req.files.upload instanceof Stream;\n  return isStream\n    ? req.files.upload\n    : fs.createReadStream(req.files.upload.path);\n};\n\nconst validateAll = (arr, compare, strict = true) => arr[strict ? 'every' : 'some'](g => compare.indexOf(g) !== -1);\n\n/**\n * Validates array groups\n */\nconst validateNamedGroups = (groups, userGroups, strict) => {\n  const namedGroups = groups\n    .filter(g => typeof g === 'string');\n\n  return namedGroups.length\n    ? validateAll(namedGroups, userGroups, strict)\n    : true;\n};\n\n/**\n * Validates matp of groups based on method:[group,...]\n */\nconst validateMethodGroups = (groups, userGroups, method, strict) => {\n  const methodGroups = groups\n    .find(g => typeof g === 'string' ? false : (method in g));\n\n  return methodGroups\n    ? validateAll(methodGroups[method], userGroups, strict)\n    : true;\n};\n\n/**\n * Validates groups\n */\nconst validateGroups = (userGroups, method, mountpoint, strict) => {\n  const groups = mountpoint.attributes.groups || [];\n  if (groups.length) {\n    const namedValid = validateNamedGroups(groups, userGroups, strict);\n    const methodValid = validateMethodGroups(groups, userGroups, method, strict);\n\n    return namedValid && methodValid;\n  }\n\n  return true;\n};\n\n/**\n * Checks permissions for given mountpoint\n */\nconst checkMountpointPermission = (req, res, method, readOnly, strict) => {\n  const userGroups = req.session.user.groups;\n\n  return ({mount}) => {\n    if (readOnly) {\n      const {attributes, name} = mount;\n\n      if (attributes.readOnly) {\n        const failed = typeof readOnly === 'function'\n          ? getPrefix(readOnly(req, res)) === name\n          : readOnly;\n\n        if (failed) {\n          return Promise.reject(createError(403, `Mountpoint '${name}' is read-only`));\n        }\n      }\n    }\n\n    if (validateGroups(userGroups, method, mount, strict)) {\n      return Promise.resolve(true);\n    }\n\n    return Promise.reject(createError(403, `Permission was denied for '${method}' in '${mount.name}'`));\n  };\n};\n\n/**\n * Creates a new custom Error\n */\nconst createError = (code, message) => {\n  const e = new Error(message);\n  e.code = code;\n  return e;\n};\n\n/**\n * Resolves a mountpoint\n */\nconst mountpointResolver = core => async (path) => {\n  const {adapters, mountpoints} = core.make('osjs/vfs');\n  const prefix = getPrefix(path);\n  const mount = mountpoints.find(m => m.name === prefix);\n\n  if (!mount) {\n    throw createError(403, `Mountpoint not found for '${prefix}'`);\n  }\n\n  const adapter = await (mount.adapter\n    ? adapters[mount.adapter]\n    : adapters.system);\n\n  return Object.freeze({mount, adapter});\n};\n\n/*\n * Assembles a given object query\n */\nconst assembleQueryData = (data) => {\n  const entries = Object\n    .entries(data)\n    .map(([k, v]) => {\n      try {\n        return [k, JSON.parse(v)];\n      } catch (e) {\n        return [k, v];\n      }\n    });\n\n  return Object.fromEntries(entries);\n};\n\n/*\n * Parses URL Body\n */\nconst parseGet = req => {\n  const {query} = url.parse(req.url, true);\n  const assembledQuery = assembleQueryData(query);\n  return Promise.resolve({fields: assembledQuery, files: {}});\n};\n\n/*\n * Parses Json Body\n */\nconst parseJson = req => {\n  const isJson = req.headers['content-type'] &&\n    req.headers['content-type'].indexOf('application/json') !== -1;\n\n  if (isJson) {\n    return {fields: req.body, files: {}};\n  }\n\n  return false;\n};\n\n/*\n * Parses Form Body\n */\nconst parseFormData = (req, {maxFieldsSize, maxFileSize}) => {\n  const form = new formidable.IncomingForm();\n  form.maxFieldsSize = maxFieldsSize;\n  form.maxFileSize = maxFileSize;\n\n  return new Promise((resolve, reject) => {\n    form.parse(req, (err, fields, files) => {\n      return err ? reject(err) : resolve({fields, files});\n    });\n  });\n};\n\n/**\n * Middleware for handling HTTP requests\n */\nconst parseFields = config => (req, res) => {\n  if (['get', 'head'].indexOf(req.method.toLowerCase()) !== -1) {\n    return Promise.resolve(parseGet(req));\n  }\n\n  const json = parseJson(req);\n  if (json) {\n    return Promise.resolve(json);\n  }\n\n  return parseFormData(req, config);\n};\n\n/**\n * A map of methods and their arguments.\n * Used for direct access via API\n */\nconst methodArguments = {\n  realpath: ['path'],\n  exists: ['path'],\n  stat: ['path'],\n  readdir: ['path'],\n  readfile: ['path'],\n  writefile: ['path', upload => ({upload})],\n  mkdir: ['path'],\n  unlink: ['path'],\n  touch: ['path'],\n  search: ['root', 'pattern'],\n  copy: ['from', 'to'],\n  rename: ['from', 'to']\n};\n\nmodule.exports = {\n  mountpointResolver,\n  createError,\n  checkMountpointPermission,\n  validateGroups,\n  streamFromRequest,\n  sanitize,\n  getPrefix,\n  parseFields,\n  errorCodes,\n  methodArguments,\n  assembleQueryData\n};\n",
    "static": true,
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/src/utils/vfs.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 247,
    "kind": "variable",
    "name": "Stream",
    "memberof": "src/utils/vfs.js",
    "static": true,
    "longname": "src/utils/vfs.js~Stream",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/utils/vfs.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 36,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 248,
    "kind": "function",
    "name": "validateAll",
    "memberof": "src/utils/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/utils/vfs.js~validateAll",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/utils/vfs.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 77,
    "undocument": true,
    "params": [
      {
        "name": "arr",
        "types": [
          "*"
        ]
      },
      {
        "name": "compare",
        "types": [
          "*"
        ]
      },
      {
        "name": "strict",
        "optional": true,
        "types": [
          "boolean"
        ],
        "defaultRaw": true,
        "defaultValue": "true"
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 249,
    "kind": "function",
    "name": "validateNamedGroups",
    "memberof": "src/utils/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/utils/vfs.js~validateNamedGroups",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/utils/vfs.js",
    "importStyle": null,
    "description": "Validates array groups",
    "lineNumber": 82,
    "params": [
      {
        "name": "groups",
        "types": [
          "*"
        ]
      },
      {
        "name": "userGroups",
        "types": [
          "*"
        ]
      },
      {
        "name": "strict",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 250,
    "kind": "function",
    "name": "validateMethodGroups",
    "memberof": "src/utils/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/utils/vfs.js~validateMethodGroups",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/utils/vfs.js",
    "importStyle": null,
    "description": "Validates matp of groups based on method:[group,...]",
    "lineNumber": 94,
    "params": [
      {
        "name": "groups",
        "types": [
          "*"
        ]
      },
      {
        "name": "userGroups",
        "types": [
          "*"
        ]
      },
      {
        "name": "method",
        "types": [
          "*"
        ]
      },
      {
        "name": "strict",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 251,
    "kind": "function",
    "name": "parseGet",
    "memberof": "src/utils/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/utils/vfs.js~parseGet",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/utils/vfs.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 195,
    "undocument": true,
    "params": [
      {
        "name": "req",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 252,
    "kind": "function",
    "name": "parseJson",
    "memberof": "src/utils/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/utils/vfs.js~parseJson",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/utils/vfs.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 204,
    "undocument": true,
    "params": [
      {
        "name": "req",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "boolean"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 253,
    "kind": "function",
    "name": "parseFormData",
    "memberof": "src/utils/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/utils/vfs.js~parseFormData",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/utils/vfs.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 218,
    "undocument": true,
    "params": [
      {
        "name": "req",
        "types": [
          "*"
        ]
      },
      {
        "name": "objectPattern1",
        "types": [
          "{\"maxFieldsSize\": *, \"maxFileSize\": *}"
        ],
        "defaultRaw": {
          "maxFieldsSize": null,
          "maxFileSize": null
        },
        "defaultValue": "{\"maxFieldsSize\":null,\"maxFileSize\":null}"
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 254,
    "kind": "function",
    "name": "mountpointResolver",
    "memberof": "src/utils/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/utils/vfs.js~mountpointResolver",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/utils/vfs.js",
    "importStyle": "{mountpointResolver}",
    "description": "Resolves a mountpoint",
    "lineNumber": 159,
    "params": [
      {
        "name": "core",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 255,
    "kind": "function",
    "name": "createError",
    "memberof": "src/utils/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/utils/vfs.js~createError",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/utils/vfs.js",
    "importStyle": "{createError}",
    "description": "Creates a new custom Error",
    "lineNumber": 150,
    "params": [
      {
        "name": "code",
        "types": [
          "*"
        ]
      },
      {
        "name": "message",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 256,
    "kind": "function",
    "name": "checkMountpointPermission",
    "memberof": "src/utils/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/utils/vfs.js~checkMountpointPermission",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/utils/vfs.js",
    "importStyle": "{checkMountpointPermission}",
    "description": "Checks permissions for given mountpoint",
    "lineNumber": 121,
    "params": [
      {
        "name": "req",
        "types": [
          "*"
        ]
      },
      {
        "name": "res",
        "types": [
          "*"
        ]
      },
      {
        "name": "method",
        "types": [
          "*"
        ]
      },
      {
        "name": "readOnly",
        "types": [
          "*"
        ]
      },
      {
        "name": "strict",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 257,
    "kind": "function",
    "name": "validateGroups",
    "memberof": "src/utils/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/utils/vfs.js~validateGroups",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/utils/vfs.js",
    "importStyle": "{validateGroups}",
    "description": "Validates groups",
    "lineNumber": 106,
    "params": [
      {
        "name": "userGroups",
        "types": [
          "*"
        ]
      },
      {
        "name": "method",
        "types": [
          "*"
        ]
      },
      {
        "name": "mountpoint",
        "types": [
          "*"
        ]
      },
      {
        "name": "strict",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 258,
    "kind": "function",
    "name": "streamFromRequest",
    "memberof": "src/utils/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/utils/vfs.js~streamFromRequest",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/utils/vfs.js",
    "importStyle": "{streamFromRequest}",
    "description": "Gets the stream from a HTTP request",
    "lineNumber": 70,
    "params": [
      {
        "name": "req",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 259,
    "kind": "function",
    "name": "sanitize",
    "memberof": "src/utils/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/utils/vfs.js~sanitize",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/utils/vfs.js",
    "importStyle": "{sanitize}",
    "description": "Sanitizes a path",
    "lineNumber": 54,
    "params": [
      {
        "name": "filename",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 260,
    "kind": "function",
    "name": "getPrefix",
    "memberof": "src/utils/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/utils/vfs.js~getPrefix",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/utils/vfs.js",
    "importStyle": "{getPrefix}",
    "description": "Gets prefix of a VFS path",
    "lineNumber": 49,
    "params": [
      {
        "name": "path",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 261,
    "kind": "function",
    "name": "parseFields",
    "memberof": "src/utils/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/utils/vfs.js~parseFields",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/utils/vfs.js",
    "importStyle": "{parseFields}",
    "description": "Middleware for handling HTTP requests",
    "lineNumber": 233,
    "params": [
      {
        "name": "config",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 262,
    "kind": "variable",
    "name": "errorCodes",
    "memberof": "src/utils/vfs.js",
    "static": true,
    "longname": "src/utils/vfs.js~errorCodes",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/utils/vfs.js",
    "importStyle": "{errorCodes}",
    "description": "A map of error codes",
    "lineNumber": 41,
    "type": {
      "types": [
        "{\"ENOENT\": number, \"EACCES\": number}"
      ]
    }
  },
  {
    "__docId__": 263,
    "kind": "variable",
    "name": "methodArguments",
    "memberof": "src/utils/vfs.js",
    "static": true,
    "longname": "src/utils/vfs.js~methodArguments",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/utils/vfs.js",
    "importStyle": "{methodArguments}",
    "description": "A map of methods and their arguments.\nUsed for direct access via API",
    "lineNumber": 250,
    "type": {
      "types": [
        "{\"realpath\": *, \"exists\": *, \"stat\": *, \"readdir\": *, \"readfile\": *, \"writefile\": *, \"mkdir\": *, \"unlink\": *, \"touch\": *, \"search\": *, \"copy\": *, \"rename\": *}"
      ]
    }
  },
  {
    "__docId__": 264,
    "kind": "function",
    "name": "assembleQueryData",
    "memberof": "src/utils/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/utils/vfs.js~assembleQueryData",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/utils/vfs.js",
    "importStyle": "{assembleQueryData}",
    "description": null,
    "lineNumber": 178,
    "undocument": true,
    "params": [
      {
        "name": "data",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 265,
    "kind": "file",
    "name": "src/vfs.js",
    "content": "/*\n * OS.js - JavaScript Cloud/Web Desktop Platform\n *\n * Copyright (c) Anders Evenrud <andersevenrud@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * @author  Anders Evenrud <andersevenrud@gmail.com>\n * @licence Simplified BSD License\n */\n\nconst fs = require('fs-extra');\nconst path = require('path');\nconst express = require('express');\nconst {Stream} = require('stream');\nconst {\n  mountpointResolver,\n  checkMountpointPermission,\n  streamFromRequest,\n  sanitize,\n  parseFields,\n  errorCodes\n} = require('./utils/vfs');\n\nconst respondNumber = result => typeof result === 'number' ? result : -1;\nconst respondBoolean = result => typeof result === 'boolean' ? result : !!result;\nconst requestPath = req => ([sanitize(req.fields.path)]);\nconst requestSearch = req => ([sanitize(req.fields.root), req.fields.pattern]);\nconst requestCross = req => ([sanitize(req.fields.from), sanitize(req.fields.to)]);\nconst requestFile = req => ([sanitize(req.fields.path), streamFromRequest(req)]);\n\n/*\n * Parses the range request headers\n */\nconst parseRangeHeader = (range, size) => {\n  const [pstart, pend] = range.replace(/bytes=/, '').split('-');\n  const start = parseInt(pstart, 10);\n  const end = pend ? parseInt(pend, 10) : undefined;\n  return [start, end];\n};\n\n/**\n * A \"finally\" for our chain\n */\nconst onDone = (req, res) => {\n  if (req.files) {\n    for (let fieldname in req.files) {\n      fs.unlink(req.files[fieldname].path, () => ({}));\n    }\n  }\n};\n\n/**\n * Wraps a vfs adapter request\n */\nconst wrapper = fn => (req, res, next) => fn(req, res)\n  .then(result => {\n    if (result instanceof Stream) {\n      result.pipe(res);\n    } else {\n      res.json(result);\n    }\n\n    onDone(req, res);\n  })\n  .catch(error => {\n    onDone(req, res);\n\n    next(error);\n  });\n\n/**\n * Creates the middleware\n */\nconst createMiddleware = core => {\n  const parse = parseFields(core.config('express'));\n\n  return (req, res, next) => parse(req, res)\n    .then(({fields, files}) => {\n      req.fields = fields;\n      req.files = files;\n\n      next();\n    })\n    .catch(error => {\n      core.logger.warn(error);\n      req.fields = {};\n      req.files = {};\n\n      next(error);\n    });\n};\n\nconst createOptions = req => {\n  const options = req.fields.options;\n  const range = req.headers && req.headers.range;\n  const session = {...req.session || {}};\n  let result = options || {};\n\n  if (typeof options === 'string') {\n    try {\n      result = JSON.parse(req.fields.options) || {};\n    } catch (e) {\n      // Allow to fall through\n    }\n  }\n\n  if (range) {\n    result.range = parseRangeHeader(req.headers.range);\n  }\n\n  return {\n    ...result,\n    session\n  };\n};\n\n// Standard request with only a target\nconst createRequestFactory = findMountpoint => (getter, method, readOnly, respond) => async (req, res) => {\n  const options = createOptions(req);\n  const args = [...getter(req, res), options];\n\n  const found = await findMountpoint(args[0]);\n  if (method === 'search') {\n    if (found.mount.attributes && found.mount.attributes.searchable === false) {\n      return [];\n    }\n  }\n\n  const {attributes} = found.mount;\n  const strict = attributes.strictGroups !== false;\n  const ranges = (!attributes.adapter || attributes.adapter === 'system') || attributes.ranges === true;\n  const vfsMethodWrapper = m => found.adapter[m]\n    ? found.adapter[m](found)(...args)\n    : Promise.reject(new Error(`Adapter does not support ${m}`));\n  const readstat = () => vfsMethodWrapper('stat').catch(() => ({}));\n  await checkMountpointPermission(req, res, method, readOnly, strict)(found);\n\n  const result = await vfsMethodWrapper(method);\n  if (method === 'readfile') {\n    const stat = await readstat();\n\n    if (ranges && options.range) {\n      try {\n        if (stat.size) {\n          const size = stat.size;\n          const [start, end] = options.range;\n          const realEnd = end ? end : size - 1;\n          const chunksize = (realEnd - start) + 1;\n\n          res.writeHead(206, {\n            'Content-Range': `bytes ${start}-${realEnd}/${size}`,\n            'Accept-Ranges': 'bytes',\n            'Content-Length': chunksize,\n            'Content-Type': stat.mime\n          });\n        }\n      } catch (e) {\n        console.warn('Failed to send a ranged response', e);\n      }\n    } else if (stat.mime) {\n      res.append('Content-Type', stat.mime);\n    }\n\n    if (options.download) {\n      const filename = encodeURIComponent(path.basename(args[0]));\n      res.append('Content-Disposition', `attachment; filename*=utf-8''${filename}`);\n    }\n  }\n\n  return respond ? respond(result) : result;\n};\n\n// Request that has a source and target\nconst createCrossRequestFactory = findMountpoint => (getter, method, respond) => async (req, res) => {\n  const [from, to, options] = [...getter(req, res), createOptions(req)];\n\n  const srcMount = await findMountpoint(from);\n  const destMount = await findMountpoint(to);\n  const sameAdapter = srcMount.adapter === destMount.adapter;\n\n  const srcStrict = srcMount.mount.attributes.strictGroups !== false;\n  const destStrict = destMount.mount.attributes.strictGroups !== false;\n  await checkMountpointPermission(req, res, 'readfile', false, srcStrict)(srcMount);\n  await checkMountpointPermission(req, res, 'writefile', true, destStrict)(destMount);\n\n  if (sameAdapter) {\n    const result = await srcMount\n      .adapter[method](srcMount, destMount)(from, to, options);\n\n    return !!result;\n  }\n\n  // Simulates a copy/move\n  const stream = await srcMount.adapter\n    .readfile(srcMount)(from, options);\n\n  const result = await destMount.adapter\n    .writefile(destMount)(to, stream, options);\n\n  if (method === 'rename') {\n    await srcMount.adapter\n      .unlink(srcMount)(from, options);\n  }\n\n  return !!result;\n};\n\n/*\n * VFS Methods\n */\nconst vfs = core => {\n  const findMountpoint = mountpointResolver(core);\n  const createRequest = createRequestFactory(findMountpoint);\n  const createCrossRequest = createCrossRequestFactory(findMountpoint);\n\n  // Wire up all available VFS events\n  return {\n    capabilities: createRequest(requestPath, 'capabilities', false),\n    realpath: createRequest(requestPath, 'realpath', false),\n    exists: createRequest(requestPath, 'exists', false, respondBoolean),\n    stat: createRequest(requestPath, 'stat', false),\n    readdir: createRequest(requestPath, 'readdir', false),\n    readfile: createRequest(requestPath, 'readfile', false),\n    writefile: createRequest(requestFile, 'writefile', true, respondNumber),\n    mkdir: createRequest(requestPath, 'mkdir', true, respondBoolean),\n    unlink: createRequest(requestPath, 'unlink', true, respondBoolean),\n    touch: createRequest(requestPath, 'touch', true, respondBoolean),\n    search: createRequest(requestSearch, 'search', false),\n    copy: createCrossRequest(requestCross, 'copy'),\n    rename: createCrossRequest(requestCross, 'rename')\n  };\n};\n\n/*\n * Creates a new VFS Express router\n */\nmodule.exports = core => {\n  const router = express.Router();\n  const methods = vfs(core);\n  const middleware = createMiddleware(core);\n  const {isAuthenticated} = core.make('osjs/express');\n  const vfsGroups = core.config('auth.vfsGroups', []);\n  const logEnabled = core.config('development');\n\n  // Middleware first\n  router.use(isAuthenticated(vfsGroups));\n  router.use(middleware);\n\n  // Then all VFS routes (needs implementation above)\n  router.get('/capabilities', wrapper(methods.capabilities));\n  router.get('/exists', wrapper(methods.exists));\n  router.get('/stat', wrapper(methods.stat));\n  router.get('/readdir', wrapper(methods.readdir));\n  router.get('/readfile', wrapper(methods.readfile));\n  router.post('/writefile', wrapper(methods.writefile));\n  router.post('/rename', wrapper(methods.rename));\n  router.post('/copy', wrapper(methods.copy));\n  router.post('/mkdir', wrapper(methods.mkdir));\n  router.post('/unlink', wrapper(methods.unlink));\n  router.post('/touch', wrapper(methods.touch));\n  router.post('/search', wrapper(methods.search));\n\n  // Finally catch promise exceptions\n  router.use((error, req, res, next) => {\n    // TODO: Better error messages\n    const code = typeof error.code === 'number'\n      ? error.code\n      : (errorCodes[error.code] || 400);\n\n    if (logEnabled) {\n      console.error(error);\n    }\n\n    res.status(code)\n      .json({\n        error: error.toString(),\n        stack: logEnabled ? error.stack : undefined\n      });\n  });\n\n  return {router, methods};\n};\n",
    "static": true,
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/src/vfs.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 266,
    "kind": "variable",
    "name": "Stream",
    "memberof": "src/vfs.js",
    "static": true,
    "longname": "src/vfs.js~Stream",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/vfs.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 35,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 267,
    "kind": "variable",
    "name": "mountpointResolver",
    "memberof": "src/vfs.js",
    "static": true,
    "longname": "src/vfs.js~mountpointResolver",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/vfs.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 37,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 268,
    "kind": "function",
    "name": "respondNumber",
    "memberof": "src/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/vfs.js~respondNumber",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/vfs.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 46,
    "undocument": true,
    "params": [
      {
        "name": "result",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 269,
    "kind": "function",
    "name": "respondBoolean",
    "memberof": "src/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/vfs.js~respondBoolean",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/vfs.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 47,
    "undocument": true,
    "params": [
      {
        "name": "result",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 270,
    "kind": "function",
    "name": "requestPath",
    "memberof": "src/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/vfs.js~requestPath",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/vfs.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 48,
    "undocument": true,
    "params": [
      {
        "name": "req",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 271,
    "kind": "function",
    "name": "requestSearch",
    "memberof": "src/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/vfs.js~requestSearch",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/vfs.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 49,
    "undocument": true,
    "params": [
      {
        "name": "req",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 272,
    "kind": "function",
    "name": "requestCross",
    "memberof": "src/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/vfs.js~requestCross",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/vfs.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 50,
    "undocument": true,
    "params": [
      {
        "name": "req",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 273,
    "kind": "function",
    "name": "requestFile",
    "memberof": "src/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/vfs.js~requestFile",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/vfs.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 51,
    "undocument": true,
    "params": [
      {
        "name": "req",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 274,
    "kind": "function",
    "name": "parseRangeHeader",
    "memberof": "src/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/vfs.js~parseRangeHeader",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/vfs.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 56,
    "undocument": true,
    "params": [
      {
        "name": "range",
        "types": [
          "*"
        ]
      },
      {
        "name": "size",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "undefined[]"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 275,
    "kind": "function",
    "name": "onDone",
    "memberof": "src/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/vfs.js~onDone",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/vfs.js",
    "importStyle": null,
    "description": "A \"finally\" for our chain",
    "lineNumber": 66,
    "params": [
      {
        "name": "req",
        "types": [
          "*"
        ]
      },
      {
        "name": "res",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 276,
    "kind": "function",
    "name": "wrapper",
    "memberof": "src/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/vfs.js~wrapper",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/vfs.js",
    "importStyle": null,
    "description": "Wraps a vfs adapter request",
    "lineNumber": 77,
    "params": [
      {
        "name": "fn",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 277,
    "kind": "function",
    "name": "createMiddleware",
    "memberof": "src/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/vfs.js~createMiddleware",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/vfs.js",
    "importStyle": null,
    "description": "Creates the middleware",
    "lineNumber": 96,
    "params": [
      {
        "name": "core",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 278,
    "kind": "function",
    "name": "createOptions",
    "memberof": "src/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/vfs.js~createOptions",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/vfs.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 115,
    "undocument": true,
    "params": [
      {
        "name": "req",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "{...result: Object, \"session\": *}"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 279,
    "kind": "function",
    "name": "createRequestFactory",
    "memberof": "src/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/vfs.js~createRequestFactory",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/vfs.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 140,
    "undocument": true,
    "params": [
      {
        "name": "findMountpoint",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 280,
    "kind": "function",
    "name": "createCrossRequestFactory",
    "memberof": "src/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/vfs.js~createCrossRequestFactory",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/vfs.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 196,
    "undocument": true,
    "params": [
      {
        "name": "findMountpoint",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 281,
    "kind": "function",
    "name": "vfs",
    "memberof": "src/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/vfs.js~vfs",
    "access": "public",
    "export": false,
    "importPath": "@osjs/server/src/vfs.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 233,
    "undocument": true,
    "params": [
      {
        "name": "core",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "{\"capabilities\": *, \"realpath\": *, \"exists\": *, \"stat\": *, \"readdir\": *, \"readfile\": *, \"writefile\": *, \"mkdir\": *, \"unlink\": *, \"touch\": *, \"search\": *, \"copy\": *, \"rename\": *}"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 282,
    "kind": "function",
    "name": "vfs",
    "memberof": "src/vfs.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/vfs.js~vfs",
    "access": "public",
    "export": true,
    "importPath": "@osjs/server/src/vfs.js",
    "importStyle": "vfs",
    "description": null,
    "lineNumber": 259,
    "undocument": true,
    "params": [
      {
        "name": "core",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "{\"router\": *, \"methods\": *}"
      ]
    },
    "ignore": true
  },
  {
    "kind": "index",
    "content": "<p align=\"center\">\n  <img alt=\"OS.js Logo\" src=\"https://raw.githubusercontent.com/os-js/gfx/master/logo-big.png\" />\n</p>\n\n[OS.js](https://www.os-js.org/) is an [open-source](https://raw.githubusercontent.com/os-js/OS.js/master/LICENSE) web desktop platform with a window manager, application APIs, GUI toolkit, filesystem abstractions and much more.\n\n[![Maintainability](https://api.codeclimate.com/v1/badges/b2e4c52db03e57b4ad76/maintainability)](https://codeclimate.com/github/os-js/osjs-server/maintainability)\n[![Test Coverage](https://api.codeclimate.com/v1/badges/b2e4c52db03e57b4ad76/test_coverage)](https://codeclimate.com/github/os-js/osjs-server/test_coverage)\n\n[![Support](https://img.shields.io/badge/patreon-support-orange.svg)](https://www.patreon.com/user?u=2978551&ty=h&u=2978551)\n[![Support](https://img.shields.io/badge/opencollective-donate-red.svg)](https://opencollective.com/osjs)\n[![Donate](https://img.shields.io/badge/liberapay-donate-yellowgreen.svg)](https://liberapay.com/os-js/)\n[![Donate](https://img.shields.io/badge/paypal-donate-yellow.svg)](https://paypal.me/andersevenrud)\n[![Community](https://img.shields.io/badge/join-community-green.svg)](https://community.os-js.org/)\n\n# OS.js v3 Server\n\nThis is the main node server module for OS.js.\n\nContains all services and interfaces required to run a node server for OS.js\n\n## Contribution\n\n* **Sponsor on [Github](https://github.com/sponsors/andersevenrud)**\n* **Become a [Patreon](https://www.patreon.com/user?u=2978551&ty=h&u=2978551)**\n* **Support on [Open Collective](https://opencollective.com/osjs)**\n* [Contribution Guide](https://github.com/os-js/OS.js/blob/master/CONTRIBUTING.md)\n\n## Documentation\n\nSee the [Official Manuals](https://manual.os-js.org/) for articles, tutorials and guides.\n\n## Links\n\n* [Official Chat](https://gitter.im/os-js/OS.js)\n* [Community Forums and Announcements](https://community.os-js.org/)\n* [Homepage](https://os-js.org/)\n* [Twitter](https://twitter.com/osjsorg) ([author](https://twitter.com/andersevenrud))\n* [Facebook](https://www.facebook.com/os.js.org)\n* [Docker Hub](https://hub.docker.com/u/osjs/)\n",
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/README.md",
    "name": "./README.md",
    "static": true,
    "access": "public"
  },
  {
    "kind": "packageJSON",
    "content": "{\n  \"name\": \"@osjs/server\",\n  \"version\": \"3.3.3\",\n  \"description\": \"OS.js Server\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"test\": \"npm run eslint && npm run jest\",\n    \"jest\": \"jest\",\n    \"coverage\": \"jest --coverage\",\n    \"eslint\": \"eslint index.js src\",\n    \"prepublishOnly\": \"npm run test\",\n    \"prepare\": \"husky install\"\n  },\n  \"files\": [\n    \"src/\",\n    \"index.js\",\n    \"README.md\",\n    \"CHANGELOG.md\",\n    \"LICENSE\"\n  ],\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://github.com/os-js/osjs-server.git\"\n  },\n  \"keywords\": [\n    \"osjs\"\n  ],\n  \"author\": \"Anders Evenrud <andersevenrud@gmail.com>\",\n  \"license\": \"BSD-2-Clause\",\n  \"bugs\": {\n    \"url\": \"https://github.com/os-js/osjs-server/issues\"\n  },\n  \"engines\": {\n    \"node\": \">=12.0.0\"\n  },\n  \"homepage\": \"https://github.com/os-js/osjs-server#readme\",\n  \"dependencies\": {\n    \"@osjs/common\": \"^3.0.12\",\n    \"body-parser\": \"^1.19.0\",\n    \"chokidar\": \"^3.4.3\",\n    \"connect-loki\": \"^1.1.0\",\n    \"consola\": \"^2.15.0\",\n    \"deepmerge\": \"^4.2.2\",\n    \"express\": \"^4.17.1\",\n    \"express-http-proxy\": \"^1.6.2\",\n    \"express-session\": \"^1.17.1\",\n    \"express-ws\": \"^4.0.0\",\n    \"fast-glob\": \"^2.2.7\",\n    \"filehound\": \"^1.17.4\",\n    \"formidable\": \"^1.2.2\",\n    \"fs-extra\": \"^9.0.1\",\n    \"mime\": \"^2.4.6\",\n    \"minimist\": \"^1.2.5\",\n    \"morgan\": \"^1.10.0\",\n    \"nocache\": \"^2.1.0\",\n    \"sanitize-filename\": \"^1.6.3\",\n    \"uuid\": \"^8.3.1\"\n  },\n  \"devDependencies\": {\n    \"@commitlint/cli\": \"^17.1.2\",\n    \"@commitlint/config-conventional\": \"^17.1.0\",\n    \"@osjs/dev-meta\": \"^2.2.0\",\n    \"jest-express\": \"^1.12.0\",\n    \"temp\": \"^0.9.4\",\n    \"husky\": \"^8.0.0\"\n  },\n  \"eslintConfig\": {\n    \"env\": {\n      \"browser\": true,\n      \"node\": true\n    },\n    \"parserOptions\": {\n      \"sourceType\": \"module\"\n    },\n    \"extends\": \"@osjs/eslint-config\"\n  },\n  \"esdoc\": {\n    \"source\": \"./src\",\n    \"destination\": \"./doc\",\n    \"plugins\": [\n      {\n        \"name\": \"esdoc-standard-plugin\",\n        \"option\": {\n          \"brand\": {\n            \"title\": \"OS.js Server API\",\n            \"description\": \"OS.js Server API Documentation\",\n            \"repository\": \"https://github.com/os-js/osjs-core\",\n            \"author\": \"Anders Evenrud <andersevenrud@gmail.com>\"\n          },\n          \"lint\": {\n            \"enable\": false\n          },\n          \"coverage\": {\n            \"enable\": false\n          },\n          \"undocumentIdentifier\": {\n            \"enable\": false\n          }\n        }\n      },\n      {\n        \"name\": \"esdoc-publish-html-plugin\"\n      },\n      {\n        \"name\": \"esdoc-ecmascript-proposal-plugin\",\n        \"option\": {\n          \"all\": true\n        }\n      },\n      {\n        \"name\": \"esdoc-node\"\n      }\n    ]\n  },\n  \"jest\": {\n    \"collectCoverage\": true,\n    \"coverageReporters\": [\n      \"lcov\"\n    ],\n    \"moduleNameMapper\": {\n      \"^osjs$\": \"<rootDir>/__mocks__/core.js\"\n    },\n    \"coveragePathIgnorePatterns\": [\n      \"src/esdoc.js\",\n      \"src/config.js\",\n      \"src/providers\",\n      \"/node_modules/\"\n    ]\n  },\n  \"commitlint\": {\n    \"extends\": [\n      \"@commitlint/config-conventional\"\n    ]\n  }\n}\n",
    "longname": "/home/runner/work/manual.os-js.org/manual.os-js.org/repos/osjs-server/package.json",
    "name": "package.json",
    "static": true,
    "access": "public"
  }
]